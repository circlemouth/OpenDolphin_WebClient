#1 [internal] load local bake definitions
#1 reading from stdin 493B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 4.38kB done
#2 DONE 0.0s

#3 [auth] docker/dockerfile:pull token for registry-1.docker.io
#3 DONE 0.0s

#4 resolve image config for docker-image://docker.io/docker/dockerfile:1.7
#4 DONE 2.1s

#5 docker-image://docker.io/docker/dockerfile:1.7@sha256:a57df69d0ea827fb7266491f2813635de6f17269be881f696fbfdf2d83dda33e
#5 resolve docker.io/docker/dockerfile:1.7@sha256:a57df69d0ea827fb7266491f2813635de6f17269be881f696fbfdf2d83dda33e 0.0s done
#5 CACHED

#6 [auth] library/maven:pull token for registry-1.docker.io
#6 DONE 0.0s

#7 [internal] load metadata for docker.io/library/maven:3.9.6-eclipse-temurin-17
#7 DONE 0.8s

#8 [internal] load metadata for quay.io/wildfly/wildfly:33.0.2.Final-jdk17
#8 DONE 1.0s

#9 [internal] load .dockerignore
#9 transferring context: 133B done
#9 DONE 0.0s

#10 [stage-1  1/11] FROM quay.io/wildfly/wildfly:33.0.2.Final-jdk17@sha256:72d2a8a60c5422d0f929bfaf329c9fcf5df26d402ff8bb8b10297ff4f714c33a
#10 resolve quay.io/wildfly/wildfly:33.0.2.Final-jdk17@sha256:72d2a8a60c5422d0f929bfaf329c9fcf5df26d402ff8bb8b10297ff4f714c33a 0.0s done
#10 DONE 0.0s

#11 [build  1/17] FROM docker.io/library/maven:3.9.6-eclipse-temurin-17@sha256:29a1658b1f3078e07c2b17f7b519b45eb47f65d9628e887eac45a8c5c8f939d4
#11 resolve docker.io/library/maven:3.9.6-eclipse-temurin-17@sha256:29a1658b1f3078e07c2b17f7b519b45eb47f65d9628e887eac45a8c5c8f939d4 0.0s done
#11 DONE 0.0s

#12 [internal] load build context
#12 transferring context: 125.43kB 0.1s done
#12 DONE 0.1s

#13 [build  7/17] COPY ext_lib ./ext_lib
#13 CACHED

#14 [stage-1  2/11] COPY --from=build /workspace/server-modernized/target/opendolphin-server.war /opt/jboss/wildfly/standalone/deployments/opendolphin-server.war
#14 CACHED

#15 [build 13/17] RUN mkdir -p /tmp/hbcompat/src/org/hibernate/type /tmp/hbcompat/classes
#15 CACHED

#16 [build  9/17] RUN mvn -N -f pom.server-modernized.xml -s /tmp/maven-settings.xml -B install:install-file -Dfile=ext_lib/iTextAsian.jar -DgroupId=opendolphin -DartifactId=itext-font -Dversion=1.0 -Dpackaging=jar
#16 CACHED

#17 [build 11/17] RUN mvn -N -f pom.server-modernized.xml -s /tmp/maven-settings.xml -B dependency:get -Dartifact=org.postgresql:postgresql:42.7.3
#17 CACHED

#18 [build 12/17] RUN mvn -N -f pom.server-modernized.xml -s /tmp/maven-settings.xml -B dependency:get -Dartifact=org.hibernate:hibernate-core:5.0.10.Final
#18 CACHED

#19 [build  3/17] COPY pom.xml ./
#19 CACHED

#20 [build 15/17] RUN javac -cp /root/.m2/repository/org/hibernate/hibernate-core/5.0.10.Final/hibernate-core-5.0.10.Final.jar -d /tmp/hbcompat/classes /tmp/hbcompat/src/org/hibernate/type/StringClobType.java
#20 CACHED

#21 [build 14/17] RUN cat <<'JAVA' > /tmp/hbcompat/src/org/hibernate/type/StringClobType.java
#21 CACHED

#22 [build  2/17] WORKDIR /workspace
#22 CACHED

#23 [build  4/17] RUN grep -v '<module>server</module>' pom.xml | grep -v '<module>client</module>' > pom.server-modernized.xml
#23 CACHED

#24 [stage-1  3/11] COPY --from=build /root/.m2/repository/org/postgresql/postgresql/*/postgresql-*.jar /opt/jboss/postgresql-driver.jar
#24 CACHED

#25 [build 17/17] RUN mvn -f pom.server-modernized.xml -s /tmp/maven-settings.xml -B -pl server-modernized -am -DskipTests package &&     mv server-modernized/target/opendolphin-server-*.war server-modernized/target/opendolphin-server.war
#25 CACHED

#26 [build 10/17] RUN mvn -N -f pom.server-modernized.xml -s /tmp/maven-settings.xml -B install:install-file -Dfile=ext_lib/AppleJavaExtensions.jar -DgroupId=com.apple -DartifactId=AppleJavaExtensions -Dversion=1.6 -Dpackaging=jar
#26 CACHED

#27 [build  6/17] COPY server-modernized ./server-modernized
#27 CACHED

#28 [build  8/17] COPY ops/shared/docker/settings.xml /tmp/maven-settings.xml
#28 CACHED

#29 [build 16/17] RUN jar cf /tmp/hbcompat/string-clob-type-compat.jar -C /tmp/hbcompat/classes .
#29 CACHED

#30 [stage-1  4/11] COPY --from=build /tmp/hbcompat/string-clob-type-compat.jar /opt/jboss/string-clob-type-compat.jar
#30 CACHED

#31 [build  5/17] COPY common ./common
#31 CACHED

#32 [stage-1  5/11] COPY ops/shared/docker/custom.properties /opt/jboss/wildfly/custom.properties
#32 CACHED

#33 [stage-1  6/11] COPY ops/modernized-server/docker/configure-wildfly.cli /opt/jboss/configure-wildfly.cli
#33 DONE 0.0s

#34 [stage-1  7/11] COPY ops/shared/docker/bootstrap.sh /opt/jboss/bootstrap.sh
#34 DONE 0.0s

#35 [stage-1  8/11] RUN chmod +x /opt/jboss/bootstrap.sh
#35 DONE 0.1s

#36 [stage-1  9/11] RUN mkdir -p /opt/jboss/tmp/WEB-INF/lib &&     mv /opt/jboss/string-clob-type-compat.jar /opt/jboss/tmp/WEB-INF/lib/ &&     cd /opt/jboss/tmp &&     jar uf /opt/jboss/wildfly/standalone/deployments/opendolphin-server.war -C /opt/jboss/tmp WEB-INF &&     rm -rf /opt/jboss/tmp
#36 DONE 1.1s

#37 [stage-1 10/11] RUN /opt/jboss/wildfly/bin/jboss-cli.sh --file=/opt/jboss/configure-wildfly.cli &&     rm -f /opt/jboss/configure-wildfly.cli &&     rm -rf /opt/jboss/wildfly/standalone/configuration/standalone_xml_history
#37 0.646 [0m06:54:22,467 INFO  [org.jboss.modules] (CLI command executor) JBoss Modules version 2.1.5.Final
#37 0.646 [0m[0m06:54:22,496 INFO  [org.jboss.msc] (CLI command executor) JBoss MSC version 1.5.5.Final
#37 0.670 [0m[0m06:54:22,504 INFO  [org.jboss.threads] (CLI command executor) JBoss Threads version 2.4.0.Final
#37 0.678 [0m[0m06:54:22,539 INFO  [org.jboss.as] (MSC service thread 1-1) WFLYSRV0049: WildFly 33.0.2.Final (WildFly Core 25.0.2.Final) starting
#37 0.713 [0m[0m06:54:23,216 INFO  [org.wildfly.security] (Controller Boot Thread) ELY00001: WildFly Elytron version 2.5.2.Final
#37 1.390 [0m[33m06:54:23,517 WARN  [org.wildfly.extension.elytron] (MSC service thread 1-8) WFLYELY00023: KeyStore file '/opt/jboss/wildfly/standalone/configuration/application.keystore' does not exist. Used blank.
#37 1.691 [0m[33m06:54:23,522 WARN  [org.wildfly.extension.elytron] (MSC service thread 1-4) WFLYELY01084: KeyStore /opt/jboss/wildfly/standalone/configuration/application.keystore not found, it will be auto-generated on first use with a self-signed certificate for host localhost
#37 1.697 [0m[0m06:54:23,587 INFO  [org.jboss.as.server] (Controller Boot Thread) WFLYSRV0212: Resuming server
#37 1.761 [0m[0m06:54:23,589 INFO  [org.jboss.as] (Controller Boot Thread) WFLYSRV0025: WildFly 33.0.2.Final (WildFly Core 25.0.2.Final) started in 1110ms - Started 51 of 77 services (27 services are lazy, passive or on-demand) - Server configuration file in use: standalone-full.xml - Minimum feature stability level: community
#37 1.763 [0m{
#37 1.817     "outcome" => "success",
#37 1.817     "response-headers" => {
#37 1.817         "operation-requires-reload" => true,
#37 1.817         "process-state" => "reload-required"
#37 1.817     }
#37 1.817 }
#37 1.828 {
#37 1.828     "outcome" => "success",
#37 1.828     "response-headers" => {
#37 1.828         "operation-requires-reload" => true,
#37 1.828         "process-state" => "reload-required"
#37 1.828     }
#37 1.828 }
#37 1.843 [0m06:54:23,668 INFO  [org.jboss.as.controller.management-deprecated] (pool-3-thread-1) WFLYCTL0028: Attribute 'driver-name' in the resource at address '/subsystem=datasources/jdbc-driver=postgresql' is deprecated, and may be removed in a future version. See the attribute description in the output of the read-resource-description operation to learn more about the deprecation.
#37 1.843 [0m{
#37 1.851     "outcome" => "success",
#37 1.851     "response-headers" => {"process-state" => "reload-required"}
#37 1.851 }
#37 1.867 {
#37 1.867     "outcome" => "success",
#37 1.867     "response-headers" => {"process-state" => "reload-required"}
#37 1.867 }
#37 1.890 {
#37 1.890     "outcome" => "success",
#37 1.890     "response-headers" => {"process-state" => "reload-required"}
#37 1.890 }
#37 1.903 {
#37 1.903     "outcome" => "success",
#37 1.903     "response-headers" => {"process-state" => "reload-required"}
#37 1.903 }
#37 1.910 {
#37 1.910     "outcome" => "success",
#37 1.910     "response-headers" => {"process-state" => "reload-required"}
#37 1.910 }
#37 1.915 {
#37 1.915     "outcome" => "success",
#37 1.915     "response-headers" => {"process-state" => "reload-required"}
#37 1.915 }
#37 1.923 {
#37 1.923     "outcome" => "success",
#37 1.923     "response-headers" => {"process-state" => "reload-required"}
#37 1.923 }
#37 1.930 {
#37 1.930     "outcome" => "success",
#37 1.930     "response-headers" => {"process-state" => "reload-required"}
#37 1.930 }
#37 1.939 {
#37 1.939     "outcome" => "success",
#37 1.939     "response-headers" => {"process-state" => "reload-required"}
#37 1.939 }
#37 1.946 {
#37 1.946     "outcome" => "success",
#37 1.946     "response-headers" => {"process-state" => "reload-required"}
#37 1.946 }
#37 1.954 {
#37 1.954     "outcome" => "success",
#37 1.954     "response-headers" => {"process-state" => "reload-required"}
#37 1.954 }
#37 1.962 {
#37 1.962     "outcome" => "success",
#37 1.962     "response-headers" => {"process-state" => "reload-required"}
#37 1.962 }
#37 1.968 {
#37 1.968     "outcome" => "success",
#37 1.968     "response-headers" => {"process-state" => "reload-required"}
#37 1.968 }
#37 1.976 {
#37 1.976     "outcome" => "success",
#37 1.976     "response-headers" => {"process-state" => "reload-required"}
#37 1.976 }
#37 1.989 {
#37 1.989     "outcome" => "success",
#37 1.989     "response-headers" => {"process-state" => "reload-required"}
#37 1.989 }
#37 2.008 {
#37 2.008     "outcome" => "success",
#37 2.008     "response-headers" => {"process-state" => "reload-required"}
#37 2.008 }
#37 2.015 {
#37 2.015     "outcome" => "success",
#37 2.015     "response-headers" => {"process-state" => "reload-required"}
#37 2.015 }
#37 2.027 {
#37 2.027     "outcome" => "success",
#37 2.027     "response-headers" => {"process-state" => "reload-required"}
#37 2.027 }
#37 2.031 [0m06:54:23,857 INFO  [org.jboss.as.controller.management-deprecated] (pool-3-thread-1) WFLYCTL0028: Attribute 'use-transaction-setup-provider' in the resource at address '/subsystem=ee/context-service=DolphinContext' is deprecated, and may be removed in a future version. See the attribute description in the output of the read-resource-description operation to learn more about the deprecation.
#37 2.031 [0m{
#37 2.039     "outcome" => "success",
#37 2.039     "response-headers" => {"process-state" => "reload-required"}
#37 2.039 }
#37 2.051 {
#37 2.051     "outcome" => "success",
#37 2.051     "response-headers" => {"process-state" => "reload-required"}
#37 2.051 }
#37 2.062 {
#37 2.062     "outcome" => "success",
#37 2.062     "response-headers" => {"process-state" => "reload-required"}
#37 2.062 }
#37 2.072 {
#37 2.072     "outcome" => "success",
#37 2.072     "response-headers" => {"process-state" => "reload-required"}
#37 2.072 }
#37 2.078 {
#37 2.078     "outcome" => "success",
#37 2.078     "response-headers" => {"process-state" => "reload-required"}
#37 2.078 }
#37 2.086 {
#37 2.086     "outcome" => "success",
#37 2.086     "response-headers" => {"process-state" => "reload-required"}
#37 2.086 }
#37 2.094 {
#37 2.094     "outcome" => "success",
#37 2.094     "response-headers" => {"process-state" => "reload-required"}
#37 2.094 }
#37 2.099 {
#37 2.099     "outcome" => "success",
#37 2.099     "response-headers" => {"process-state" => "reload-required"}
#37 2.099 }
#37 2.114 {
#37 2.114     "outcome" => "success",
#37 2.114     "response-headers" => {"process-state" => "reload-required"}
#37 2.114 }
#37 2.124 {
#37 2.124     "outcome" => "success",
#37 2.124     "response-headers" => {"process-state" => "reload-required"}
#37 2.124 }
#37 2.133 {
#37 2.133     "outcome" => "success",
#37 2.133     "response-headers" => {"process-state" => "reload-required"}
#37 2.133 }
#37 2.143 {
#37 2.143     "outcome" => "success",
#37 2.143     "response-headers" => {"process-state" => "reload-required"}
#37 2.143 }
#37 2.153 {
#37 2.153     "outcome" => "success",
#37 2.153     "response-headers" => {"process-state" => "reload-required"}
#37 2.153 }
#37 2.163 {
#37 2.163     "outcome" => "success",
#37 2.163     "response-headers" => {"process-state" => "reload-required"}
#37 2.163 }
#37 2.170 {
#37 2.170     "outcome" => "success",
#37 2.170     "response-headers" => {"process-state" => "reload-required"}
#37 2.170 }
#37 2.176 {
#37 2.176     "outcome" => "success",
#37 2.176     "response-headers" => {"process-state" => "reload-required"}
#37 2.176 }
#37 2.182 {
#37 2.182     "outcome" => "success",
#37 2.182     "response-headers" => {"process-state" => "reload-required"}
#37 2.182 }
#37 2.188 {
#37 2.188     "outcome" => "success",
#37 2.188     "response-headers" => {"process-state" => "reload-required"}
#37 2.188 }
#37 2.194 {
#37 2.194     "outcome" => "success",
#37 2.194     "response-headers" => {"process-state" => "reload-required"}
#37 2.194 }
#37 2.200 {
#37 2.200     "outcome" => "success",
#37 2.200     "response-headers" => {"process-state" => "reload-required"}
#37 2.200 }
#37 2.207 {
#37 2.207     "outcome" => "success",
#37 2.207     "response-headers" => {"process-state" => "reload-required"}
#37 2.207 }
#37 2.215 {
#37 2.215     "outcome" => "success",
#37 2.215     "response-headers" => {"process-state" => "reload-required"}
#37 2.215 }
#37 2.228 [0m06:54:24,053 INFO  [org.jboss.as] (MSC service thread 1-2) WFLYSRV0050: WildFly 33.0.2.Final (WildFly Core 25.0.2.Final) stopped in 10ms
#37 2.228 [0m
#37 DONE 2.3s

#38 [stage-1 11/11] RUN chown -R jboss:0 /opt/jboss/wildfly /opt/jboss/bootstrap.sh /opt/jboss/postgresql-driver.jar
#38 DONE 5.9s

#39 exporting to image
#39 exporting layers
#39 exporting layers 1.3s done
#39 exporting manifest sha256:8ac4733310027341ea9503f9f6664048c119291ca29eb67b7cd4036586119046 done
#39 exporting config sha256:9efb8156158714a17328c8758f596f40dc017c5c407906d7e76ca69d817d08ba done
#39 exporting attestation manifest sha256:b79f4bafeedabe2176f45e1e93210332b47ff700de49c350206ef2da2683534b done
#39 exporting manifest list sha256:803cf61d70d225b1e60084c37eb7d9c4ce539decd745130d168d8f9e5322919e done
#39 naming to docker.io/library/modernized-headless-server-modernized-dev:latest done
#39 unpacking to docker.io/library/modernized-headless-server-modernized-dev:latest
#39 unpacking to docker.io/library/modernized-headless-server-modernized-dev:latest 0.7s done
#39 DONE 2.1s

#40 resolving provenance for metadata file
#40 DONE 0.0s
 server-modernized-dev  Built
 Network modernized-headless_default  Creating
 Network modernized-headless_default  Created
 Volume "modernized-headless_postgres-data-modernized"  Creating
 Volume "modernized-headless_postgres-data-modernized"  Created
 Container opendolphin-postgres-modernized  Creating
 Container opendolphin-postgres-modernized  Created
 Container opendolphin-server-modernized-dev  Creating
 Container opendolphin-server-modernized-dev  Created
 Container opendolphin-postgres-modernized  Starting
 Container opendolphin-postgres-modernized  Started
 Container opendolphin-postgres-modernized  Waiting
 Container opendolphin-postgres-modernized  Healthy
 Container opendolphin-server-modernized-dev  Starting
 Container opendolphin-server-modernized-dev  Started
