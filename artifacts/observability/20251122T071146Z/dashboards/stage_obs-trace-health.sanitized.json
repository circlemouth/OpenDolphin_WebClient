{
  "title": "Trace Health (Stage, sanitized)",
  "uid": "obs-trace-health-stage",
  "run_id": "20251122T071146Z",
  "description": "Stage trace pipeline health. Sanitized; env/service/facility only.",
  "schemaVersion": 39,
  "version": 1,
  "editable": false,
  "timezone": "browser",
  "time": {"from": "now-3h", "to": "now"},
  "refresh": "30s",
  "templating": {
    "list": [
      {"name": "env", "type": "custom", "query": "stage", "current": {"text": "stage", "value": "stage"}},
      {"name": "service", "type": "custom", "query": "modernized-api,async-worker", "current": {"text": "modernized-api", "value": "modernized-api"}},
      {"name": "facility", "type": "textbox", "query": "", "current": {"text": "*", "value": "*"}}
    ]
  },
  "panels": [
    {"id": 30, "type": "stat", "title": "Sampler drop %", "targets": [{"expr": "sum by (deployment_environment)(rate(otel_sampler_dropped_total{deployment_environment=\"$env\",service_name=~\"$service\",facility=~\"$facility\"}[5m])) / clamp_min(sum by (deployment_environment)(rate(otel_sampler_seen_total{deployment_environment=\"$env\",service_name=~\"$service\",facility=~\"$facility\"}[5m])),1)"}], "fieldConfig": {"defaults": {"unit": "percentunit", "thresholds": {"mode": "percentage", "steps": [{"color": "green", "value": null},{"color": "orange", "value": 5},{"color": "red", "value": 20}]}}}},
    {"id": 31, "type": "stat", "title": "TraceContext missing % (JMS)", "targets": [{"expr": "sum by (deployment_environment)(increase(messaging_tracecontext_missing_total{deployment_environment=\"$env\",queue!\"\"}[5m])) / clamp_min(sum by (deployment_environment)(increase(messaging_consumed_total{deployment_environment=\"$env\",queue!\"\"}[5m])),1)"}], "fieldConfig": {"defaults": {"unit": "percentunit", "thresholds": {"mode": "percentage", "steps": [{"color": "green", "value": null},{"color": "orange", "value": 1},{"color": "red", "value": 2.5}]}}}},
    {"id": 32, "type": "timeSeries", "title": "Correlation missing (Tempo)", "targets": [{"expr": "rate(correlation_missing_total{deployment_environment=\"$env\",service_name=~\"$service\",facility=~\"$facility\"}[5m])"}], "fieldConfig": {"defaults": {"unit": "percentunit"}}}
  ],
  "annotations": {"list": []}
}
