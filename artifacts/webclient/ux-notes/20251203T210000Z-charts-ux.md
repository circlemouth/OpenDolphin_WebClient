# 20251203T210000Z Charts UX Notes

1. DocumentTimeline/OrderConsole/OrcaSummary で保持する状態と `aria-live` の組み合わせは `docs/web-client/ux/charts-claim-ui-policy.md §10` に整理しました。受付側の `Error/Warning=assertive`・`Info=polite` の tone を踏襲しつつ、`data-run-id`/`aria-atomic=false` で二重読み上げを防止し、エラー・送信成功・マスター fallback をそれぞれ明確に区別します。
2. OrderConsole の `FilterBadge` と OrcaSummary は `missingMaster`/`fallbackUsed`/`dataSourceTransition` を `aria-live=polite` で更新し、監査メタを `audit.logUiState`/`audit.logOrcaQuery` へ流します。監査ログの `action/patientId/queueStatus/tone/ariaLive/runId` も同期させる想定です。
3. Outpatient API table（`docs/web-client/ux/charts-claim-ui-policy.md §11`）では `GET /api/pvt2/pvtList` + `/api/karte/docinfo`/`/api/karte/documents` などを受付→カルテ導線で採用し、`GET /api/patient/{patientId}` の保険情報や `/resources/orca/master/*` の `dataSourceTransition` meta を指定しました。入院 API は `N/A` とし、外来に集中する coverage としました。
4. 次の API マッピング/Playwright/a11y では本 RUN_ID を起点に、`aria-live=assertive` の error banner（ORCA エラー・未紐付・遅延）と `aria-live=polite` のデータソース transition を分離した自動検証ケースを追加してください。また、`dataSourceTransition` の履歴が `audit.logUiState` で残っていること、`missingMaster`/`fallbackUsed` 表示に `data-run-id` が付与されていることを確認し、`OrcaSummary` → `Reception` の tone を手動で match できるかチェックします。
