id,method,path,headers_profile,payload_template,expected_status,notes,trace-id,letter_lab_audit_status
rest_error_bad_request,GET,"/dolphin/activity/2025,04",ops/tests/api-smoke-test/headers/trace-session.headers,,400,"Headers=tmp/trace_http_400.headers（`{{RUN_ID}}` へ `20251111TtracefixZ` を差し込む）; Expect=Legacy/Modern 400（SystemResource#getActivities の 400 固定を再検証）。Docker/WildFly ビルド後に `send_parallel_request.sh --profile compose --run-id 20251111TtracefixZ GET /dolphin/activity/2025,04 trace_http_400` を実行し、Evidence=artifacts/parity-manual/TRACEID_JMS/20251111TtracefixZ/trace_http_400/ へ HTTP/JMS/Audit を保存予定。Checklist #49 ログ（`logs/send_parallel_request.log` , `logs/d_audit_event_*.txt`）も同階層へ集約。",trace-http-400-20251111TtracefixZ,
rest_error_unauthorized,GET,"/touch/user/doctor1,1.3.6.1.4.1.9414.72.103,dolphin",ops/tests/api-smoke-test/headers/trace-session.headers,,401,"Headers=tmp/trace_http_401.headers を複製せずそのまま使用し、`TRACE_RUN_ID=20251111TtracefixZ` で `X-Trace-Id` を `trace-http-401-20251111TtracefixZ` へ展開。Expect=Legacy 401 / Modernized 401（LogFilter が `WWW-Authenticate` を返し、Touch stack は facility fallback で 401 を維持）。Evidence=artifacts/parity-manual/TRACEID_JMS/20251111TtracefixZ/trace_http_401/ を差替予定。Checklist #73 の証跡（Legacy/Modern HTTP + JMS + `logs/logfilter_env.txt`）を同 RUN_ID に揃える。",trace-http-401-20251111TtracefixZ,
rest_error_internal,GET,"/karte/pid/INVALID,%5Bdate%5D",ops/tests/api-smoke-test/headers/trace-session.headers,,500,"Headers=tmp/trace_http_500.headers（`TRACE_RUN_ID=20251111TtracefixZ`）; Expect=Legacy/Modern 500 かつ 応答 Content-Type=TEXT/PLAIN（NumberFormatException をそのまま渡す想定）。`send_parallel_request.sh --run-id 20251111TtracefixZ GET /karte/pid/INVALID,%5Bdate%5D trace_http_500` で再取得し、Evidence=artifacts/parity-manual/TRACEID_JMS/20251111TtracefixZ/trace_http_500/ へ HTTP/Trace/JMS/Audit を保存。Checklist #74 の `d_audit_event_id_seq` ログも同 RUN_ID にリダイレクトして保持する。",trace-http-500-20251111TtracefixZ,
rest_error_schedule_unknown_entity,GET,/schedule/pvt/2025-11-09,ops/tests/api-smoke-test/headers/trace-session.headers,,200,"Headers=ops/tests/api-smoke-test/headers/trace-session.headers（`X-Trace-Id: trace-schedule-jpql`）; Expect=Legacy/Modern 200（現状 Modern JSON=`{\"list\":null}` → `remoteUser=anonymous` TODO）; Evidence=artifacts/parity-manual/JPQL/20251110T122417Z/ScheduleServiceBean/; Elytron/JACC 修正後に `d_audit_event` 採取を追加。",trace-schedule-jpql,
rest_audit_schedule_trace,GET,/schedule/pvt/2025-11-09,tmp/parity-headers/schedule_<RUN_ID>.headers,,200,"Headers=tmp/parity-headers/schedule_<RUN_ID>.headers（RUN_ID テンプレ=`20251112TauditFix`, `X-Trace-Id: trace-audit-schedule-<RUN_ID>`）; Expect=Legacy/Modern 200 かつ `d_audit_event` に `SCHEDULE_FETCH` / `SCHEDULE_DELETE` が `actor_id`・`request_id`・`patient_id` 付きで追加される。`documentsDeletedCount=0` の場合は `documentsDeletedStatus` を README に併記する。JMS は dispatcher 未実装なので `logs/jms_dolphinQueue_read-resource.{before,after}.txt` で messages-added 差分 0 を証跡化。Evidence=artifacts/parity-manual/schedule/<RUN_ID>/ 以下に HTTP/headers/Audit/JMS を保存。",trace-audit-schedule-20251112TauditFix,
rest_error_appo_missing_entity,PUT,/appo,ops/tests/api-smoke-test/headers/trace-session.headers,ops/tests/api-smoke-test/payloads/appo_cancel_sample.json,200,"Headers=ops/tests/api-smoke-test/headers/trace-session.headers（`X-Trace-Id: trace-appo-jpql`）; Payload=ops/tests/api-smoke-test/payloads/appo_cancel_sample.json; Expect=Legacy/Modern 200（reseeding 済み）; Evidence=artifacts/parity-manual/JPQL/20251110T122417Z/AppoServiceBean/; TODO: `d_audit_event` / JMS ログを揃えたら README へリンク。",trace-appo-jpql,
rest_audit_appo_trace,PUT,/appo,tmp/parity-headers/appo_<RUN_ID>.headers,ops/tests/api-smoke-test/payloads/appo_cancel_sample.json,200,"Headers=tmp/parity-headers/appo_<RUN_ID>.headers（RUN_ID=`20251112TauditFix`, `X-Trace-Id: trace-audit-appo-<RUN_ID>`）; Payload=ops/tests/api-smoke-test/payloads/appo_cancel_sample.json; Expect=Legacy/Modern 200 + `d_audit_event` に `APPOINTMENT_MUTATION` の success/failure が `actor_id`・`request_id`・`patient_id` 付きで残る（トランザクション失敗時も Audit はロールバックされない）。JMS は dispatcher 未実装のため `logs/jms_dolphinQueue_read-resource.{before,after}.txt` で差分 0 を記録。Evidence=artifacts/parity-manual/appo/<RUN_ID>/ に HTTP/headers/Audit/JMS を保存し、README に counts を整理する。",trace-audit-appo-20251112TauditFix,
rest_audit_appo_zero_mutation_todo,PUT,/appo,tmp/parity-headers/appo_<RUN_ID>.headers,ops/tests/api-smoke-test/payloads/appo_cancel_sample.json,200,"TODO: 0 件適用時でも `AuditTrailService.write` が `requestedCount>0 / appliedCount=0` を残せるか検証する。`ops/tests/api-smoke-test/payloads/appo_cancel_sample.json` から既存予約を削除済みにして再投入し、APPOINTMENT_MUTATION failure/success の両ログが `d_audit_event` に記録されること、JMS が +0/+0 であることを `artifacts/parity-manual/appo_zero_mutation/<RUN_ID>/` へ証跡化する。Tx 分離が完了するまで Pending。",trace-audit-appo-zero-mutation,
rest_error_chart_summary_seed_gap,GET,/chart/WEB1001/summary,ops/tests/api-smoke-test/headers/legacy-default.headers,,500,"Headers=ops/tests/api-smoke-test/headers/legacy-default.headers（`X-Trace-Id: trace-chart-summary-manual`）; Expect=Legacy/Modern 200 を目標（現状 Legacy=200 / Modern=400: `KarteBeanConverter` null + WEB1001 seed gap）; Evidence=artifacts/parity-manual/JPQL/20251110T122417Z/KarteServiceBean/; TODO: `ops/db/local-baseline/local_synthetic_seed.sql` 再投入 + Converter null-safe 化。",trace-chart-summary-manual,
rest_error_letter_fk,PUT,/odletter/letter,tmp/parity-headers/letter_20251111T091717Z.headers,tmp/parity-letter/letter_put_payload.json,200,"Headers=tmp/parity-headers/letter_<RUN_ID>.headers（最新: letter_20251111T091717Z.headers, TraceId=parity-letter-<RUN_ID>）; Payload=tmp/parity-letter/letter_put_payload.json。RUN_ID=`20251111TrestfixZ` では Legacy=200（戻り値 18）/Modern=200（戻り値 -38）で応答し、HTTP・meta・headers は `artifacts/parity-manual/letter/20251111TrestfixZ/rest_error_letter_fk/{legacy,modern}/` に保存済み。`logs/d_audit_event_letter.tsv` / `logs/d_audit_event_latest.tsv` は Legacy/Modern とも対象行 0 件、`logs/jms_dolphinQueue_read-resource.txt` も `message-count=0L`, `messages-added=0L` を維持。`reset_d_audit_event_seq.sql` の成果物は `artifacts/parity-manual/db/20251111TrestfixZ/{legacy,modern}/audit_event_{backup.csv,status_log.txt,validation_log.txt}` で参照。Evidence=artifacts/parity-manual/letter/20251111TrestfixZ/。",parity-letter-20251111T091717Z,"TODO (Audit/JMS 未取得)"
rest_error_lab_empty,GET,"/lab/module/WEB1001,0,5",tmp/parity-headers/lab_20251111T091717Z.headers,,200,"Headers=tmp/parity-headers/lab_<RUN_ID>.headers; RUN_ID=`20251111TrestfixZ` では Legacy/Modern とも 200 で `response.json` は `{\"list\":[]}`。HTTP/ログは `artifacts/parity-manual/lab/20251111TrestfixZ/` に集約し、`logs/d_audit_event_lab.tsv` / `logs/d_audit_event_latest.tsv` は TraceId 行 0 件のまま、`logs/jms_dolphinQueue_read-resource.txt` も 0L→0L を確認。Audit バックアップは `artifacts/parity-manual/db/20251111TrestfixZ/{legacy,modern}/audit_event_*` を参照。Evidence=artifacts/parity-manual/lab/20251111TrestfixZ/。",parity-lab-20251111T091717Z,"TODO (Audit/JMS 未取得)"
rest_error_stamp_data_exception,PUT,/stamp/tree,tmp/parity-headers/stamp_20251111TstampfixZ3.headers,tmp/parity-letter/stamp_tree_payload.json,"200 (legacy) / 200 (modern)","Headers=tmp/parity-headers/stamp_<RUN_ID>.headers（最新: stamp_20251111TstampfixZ3.headers, TraceId=parity-stamp-<RUN_ID>）。RUN_ID=`20251111TstampfixZ3` は helper コンテナ（`--network legacy-vs-modern_default`）から `BASE_URL_{LEGACY,MODERN}=http://opendolphin-{server,server-modernized-dev}:8080/openDolphin/resources` で実施し、`stamp_tree_payload.json` を GET `/stamp/tree/9001` の最新版（versionNumber=11）へ同期してから投入。Legacy/Modern とも 200 応答で、HTTP/headers/meta は `artifacts/parity-manual/stamp/20251111TstampfixZ3/{stamp_tree_user9001,PUT_stamp_tree,rest_error_stamp_data_exception}/` に保存済み。DB 側は `ops/db/local-baseline/stamp_tree_oid_cast.sql` と `CREATE TABLE d_subscribed_tree (...)` をモダナイズ DB へ反映し、`logs/d_stamp_tree_cast_migration.txt` と `logs/d_subscribed_tree_migration.txt` に手順を追記。Audit/JMS 証跡は `logs/d_audit_event_stamp_{legacy,modern}.tsv`（TraceId=parity-stamp-20251111TstampfixZ3）と `logs/jms_dolphinQueue_read-resource.txt`（`messages-added=4L`, `message-count=0L`）で確認できる。",parity-stamp-20251111TstampfixZ3,
rest_error_stamp_tree_public,GET,"/stamp/tree/9001/public",tmp/parity-headers/stamp_tree_public_<RUN_ID>.headers,,"200 (legacy) / 200 (modern) → TODO: 実装後 RUN_ID=20251113TstampPublicPlanZ1 で証跡採取","Headers=tmp/parity-headers/stamp_tree_public_<RUN_ID>.headers（テンプレ: `_TEMPLATE.headers`）。RUN_ID=`20251111TstampfixZ4` では helper コンテナ経由で採取し、HTTP/headers/meta を `artifacts/parity-manual/stamp/20251111TstampfixZ4/stamp_tree_public/{legacy,modern}/` に保存。Legacy 仕様は `GET /stamp/published/tree` + LogFilter ヘッダー認証（`docs/server/LEGACY_REST_API_INVENTORY.md` §5, `docs/server-modernization/phase2/notes/security-elytron-migration.md` §1）で公開ツリーを返す想定。Resource 実装 or UI 差し替え完了後は RUN_ID=`20251113TstampPublicPlanZ1` で HTTP/Audit/JMS を撮り直し、`TRACEID_JMS_RUNBOOK.md` Appendix A の before/after 取得に従う。",parity-stamp-tree-public-<RUN_ID>,
rest_error_stamp_tree_shared,GET,"/stamp/tree/9001/shared",tmp/parity-headers/stamp_tree_shared_<RUN_ID>.headers,,"200 (legacy) / 200 (modern) → TODO: 実装後 RUN_ID=20251113TstampPublicPlanZ1 で証跡採取","Headers=tmp/parity-headers/stamp_tree_shared_<RUN_ID>.headers（テンプレ: `_TEMPLATE.headers`）。RUN_ID=`20251111TstampfixZ5` の HTTP/headers は `artifacts/parity-manual/stamp/20251111TstampfixZ5/stamp_tree_shared/{legacy,modern}/` に保存。Legacy は共有カタログを `/stamp/subscribed/tree`（POST/DELETE、レスポンス=購読 ID 列）で管理していたため Appendix A.5 に沿った再設計が必要。UI 切替 or REST alias が完了したら RUN_ID=`20251113TstampPublicPlanZ1` で 200/200 + Audit/JMS を取得し、`logs/d_audit_event_stamp_shared_{legacy,modern}.tsv` に TraceId を残す。",parity-stamp-tree-shared-<RUN_ID>,
rest_error_stamp_tree_published,GET,"/stamp/tree/9001/published",tmp/parity-headers/stamp_tree_published_<RUN_ID>.headers,,"200 (legacy) / 200 (modern) → TODO: 実装後 RUN_ID=20251113TstampPublicPlanZ1 で証跡採取","Headers=tmp/parity-headers/stamp_tree_published_<RUN_ID>.headers。RUN_ID=`20251111TstampfixZ6` の結果・ログは `artifacts/parity-manual/stamp/20251111TstampfixZ6/stamp_tree_published/{legacy,modern}/` へ保存済み。`/stamp/published/tree` が正式 GET ルートであることを Appendix A.5 に統合済みなので、UI/REST いずれかの改修後に 200/200 を再取得し、`logs/d_audit_event_stamp_published_{legacy,modern}.tsv` と `logs/jms_dolphinQueue_read-resource{,_legacy}.txt` を RUN_ID=`20251113TstampPublicPlanZ1` で差し替える。",parity-stamp-tree-published-<RUN_ID>,
rest_error_claim_send,PUT,/20/adm/eht/sendClaim,tmp/claim-tests/claim_<RUN_ID>.headers,tmp/claim-tests/send_claim_success_<RUN_ID>.json,"200 (legacy) / 200 (modern)","Headers/BODY=tmp/claim-tests/claim_<RUN_ID>.headers + send_claim_success_<RUN_ID>.json（テンプレは `tmp/claim-tests/claim_TEMPLATE.headers` / `send_claim_success.json`）。RUN_ID=`20251111TclaimfixZ3` は helper コンテナ（`--network legacy-vs-modern_default`）経由で実行し、ホスト↔9080 復旧までは helper 運用を継続。事前に `ops/db/local-baseline/reset_d_audit_event_seq_batch.sql` を Legacy/Modern 両 Postgres へ適用し、`artifacts/parity-manual/db/20251111TclaimfixZ3/{legacy,modern}/audit_event_*` を保存。HTTP/JMS/Audit 証跡は `artifacts/parity-manual/TRACEID_JMS/20251111TclaimfixZ3/claim_send/`（response/meta/headers/logs）と `logs/d_audit_event_claim.tsv` へ格納し、TraceId 差分は `scripts/diff_d_audit_event_claim.sh 20251111TclaimfixZ3 20251111TclaimfixZ2` の結果を同階層 README に貼り付ける。",trace-jms-20251111TclaimfixZ3,
