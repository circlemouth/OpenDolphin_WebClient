# 07 施設ID自動補完ルーティング実装

- RUN_ID: `20251230T070455Z`
- Parent RUN_ID: `20251229T220416Z`
- YAML ID: `web-client/src/webclient_facility_prefix/07_施設ID自動補完ルーティング実装.md`

## 目的
- `/login` 直アクセス時に施設IDを補完し、施設付きログインへ正規化する。
- 旧URL/リダイレクト誘導時は履歴方針を明示し、期待通りに戻れるようにする。

## 実装内容
- `from` state に施設付きパスがある場合は最優先で補完するように変更。
- 補完できた場合は `buildFacilityPath(facilityId, '/login')` へ遷移し、
  `from` や旧URL誘導の有無に応じて `replace/push` を使い分ける方針をコメントで明文化。
- 補完不可時は `FacilityLoginEntry` で施設選択/入力へフォールバック。

## 補完ルール（C案）
1. `from` state に施設ID付きパスがあれば最優先で使用する。
2. 最近利用施設が1件なら自動補完する（複数件は選択へ）。
3. `devFacilityId` → `VITE_DEFAULT_FACILITY_ID` → `/facility.json` の順で補完する。

## テスト
- `npm test -- FacilityLoginResolver`

## 変更ファイル
- `web-client/src/features/login/FacilityLoginResolver.tsx`
- `web-client/src/features/login/__tests__/FacilityLoginResolver.test.tsx`
