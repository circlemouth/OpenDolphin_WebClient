<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆï½œ4xx/5xx TraceId ç›£æŸ»åˆ°é”ç¢ºèª</title>
    <style>
      body {
        font-family: "Hiragino Sans", "Noto Sans JP", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        line-height: 1.6;
        margin: 24px;
        background-color: #e9f0f2;
        color: #1f2a30;
      }
      .monitor-wrapper {
        max-width: 1180px;
        margin: 0 auto;
        padding: 32px;
        background: #ffffff;
        border: 1px solid #c4d3d7;
      }
      .monitor-header {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 24px;
      }
      .monitor-title {
        font-size: 26px;
        font-weight: 700;
        letter-spacing: 0.04em;
        color: #1f2a30;
      }
      .monitor-description {
        font-size: 14px;
        color: #3a4b53;
      }
      .scoreboard {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 16px;
        margin: 20px 0 28px;
      }
      .score-card {
        border: 1px solid #c4d3d7;
        background: #f8fbfc;
        padding: 16px;
      }
      .score-card h3 {
        margin: 0 0 6px;
        font-size: 14px;
        color: #2c3a40;
      }
      .score-total {
        font-size: 28px;
        font-weight: 700;
        color: #1f2a30;
      }
      .score-total span {
        font-size: 22px;
        margin-right: 6px;
      }
      .score-meta {
        font-size: 12px;
        color: #3a4b53;
      }
      .intro {
        font-size: 14px;
        padding: 14px 16px;
        background: #eef3f4;
        border: 1px solid #d0dde1;
        margin-bottom: 20px;
      }
      table.monitor-report {
        width: 100%;
        border-collapse: collapse;
        table-layout: fixed;
        background: #ffffff;
        border: 1px solid #c4d3d7;
      }
      col.timestamp-column {
        width: 180px;
      }
      col.agent-column {
        width: calc((100% - 180px) / 3);
      }
      th,
      td {
        border: 1px solid #c4d3d7;
        padding: 16px;
        vertical-align: top;
        background-color: #ffffff;
      }
      th {
        background: #d8e6e9;
        text-align: left;
        font-size: 13px;
        font-weight: 600;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        color: #2c3a40;
      }
      tbody tr:nth-child(even) td {
        background-color: #eef3f4;
      }
      details {
        display: block;
        margin: 0;
      }
      details summary {
        list-style: none;
      }
      details[open] summary {
        margin-bottom: 12px;
      }
      .details-toggle {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
        font-weight: 500;
        font-size: 13px;
        color: #1f2a30;
        padding: 0;
        background: transparent;
        border: none;
      }
      .details-toggle::before {
        content: "â–¶";
        font-size: 10px;
        transition: transform 160ms ease;
        display: inline-block;
      }
      details[open] .details-toggle::before {
        transform: rotate(90deg);
      }
      .timestamp {
        font-weight: 600;
        color: #2c3a40;
        overflow-wrap: anywhere;
      }
      pre {
        white-space: pre-wrap;
        word-break: break-word;
        margin: 0;
        font-size: 12px;
        line-height: 1.55;
        color: #1f2a30;
        background: #f2f6f7;
        border: 1px solid #c4d3d7;
        padding: 16px;
      }
      .status-badge {
        display: inline-block;
        font-size: 10px;
        font-weight: 600;
        letter-spacing: 0.02em;
        padding: 1px 6px;
        background: #d8e6e9;
        border: 1px solid #b8c9cd;
        color: #1f2a30;
        white-space: nowrap;
        line-height: 1.3;
        vertical-align: top;
      }
      .status-badge--completed {
        background: #c3d4d8;
        border-color: #aabfc5;
      }
      .status-badge--warning {
        background: #fef3cd;
        border-color: #f0e5a5;
      }
      .agent-meta {
        display: block;
        margin-bottom: 8px;
        line-height: 1.5;
      }
      .agent-meta .status-badge {
        margin-right: 6px;
      }
      .agent-label {
        display: inline;
        font-size: 13px;
        color: #3a4b53;
      }
      .radar-wrap {
        display: grid;
        grid-template-columns: 120px 1fr;
        gap: 12px;
        margin-bottom: 12px;
        align-items: center;
      }
      .radar {
        width: 120px;
        height: 120px;
      }
      .metric-list {
        margin: 0;
        padding-left: 18px;
        font-size: 12px;
        color: #2c3a40;
      }
      .metric-list li {
        margin-bottom: 4px;
      }
      .chip {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-size: 12px;
        padding: 4px 8px;
        border: 1px solid #c4d3d7;
        background: #f2f6f7;
        margin-bottom: 8px;
      }
      .link-list a {
        color: #1f2a30;
      }
    </style>
  </head>
  <body>
    <div class="monitor-wrapper">
      <header class="monitor-header">
        <h1 class="monitor-title">è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆï½œ4xx/5xx TraceId ç›£æŸ»åˆ°é”ç¢ºèª</h1>
        <p class="monitor-description">ç›£æŸ»ãƒ­ã‚°åˆ°é”ç¢ºèªã‚¿ã‚¹ã‚¯ã®å®Ÿè£…ãƒ»è¨¼è·¡ã‚’æ¯”è¼ƒè©•ä¾¡ã€‚ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°ã€å·®åˆ†ã€è¨¼è·¡ã®å“è³ªã‚’åŸºæº–ã«æ¡ç‚¹ã€‚</p>
      </header>

      <section class="intro">
        <strong>ã‚¿ã‚¹ã‚¯æ¦‚è¦</strong>: 4xx/5xx å¿œç­”æ™‚ã® TraceId ãŒç›£æŸ»ãƒ­ã‚° (d_audit_event) ã«åˆ°é”ã™ã‚‹ã“ã¨ã‚’è¨¼è·¡åŒ–ã—ã€ä¾‹å¤–ãƒ‘ã‚¹ã®ãƒ¡ã‚¿æ•´åˆã‚’ç¢ºèªã€‚
        <br />
        <strong>è©•ä¾¡è¦³ç‚¹</strong>: å®Œäº†åº¦ / è¨¼è·¡å“è³ª / å†ç¾æ€§ / é‹ç”¨é…æ…® / æ‰‹é †æ˜ç¢ºæ€§ / ãƒªã‚¹ã‚¯ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€‚
      </section>

      <section class="scoreboard">
        <div class="score-card">
          <h3>worker-audit-jms / task-1766755838278-0d5251</h3>
          <div class="score-total"><span>ğŸ¥‡</span>531 / 600</div>
          <div class="score-meta">6æŒ‡æ¨™åˆè¨ˆ: 92 + 90 + 86 + 88 + 90 + 85</div>
        </div>
        <div class="score-card">
          <h3>worker-audit-jms / task-1766755838082-bbb1a7</h3>
          <div class="score-total"><span>ğŸ¥ˆ</span>506 / 600</div>
          <div class="score-meta">6æŒ‡æ¨™åˆè¨ˆ: 88 + 85 + 82 + 86 + 85 + 80</div>
        </div>
        <div class="score-card">
          <h3>worker-audit-jms / task-1766755838538-33d777</h3>
          <div class="score-total"><span>ğŸ¥‰</span>420 / 600</div>
          <div class="score-meta">6æŒ‡æ¨™åˆè¨ˆ: 76 + 62 + 70 + 80 + 72 + 60</div>
        </div>
      </section>

      <table class="monitor-report">
        <colgroup>
          <col class="timestamp-column" />
          <col class="agent-column" />
          <col class="agent-column" />
          <col class="agent-column" />
        </colgroup>
        <thead>
          <tr>
            <th>Timestamp</th>
            <th>worker-audit-jms<br />task-1766755838278-0d5251</th>
            <th>worker-audit-jms<br />task-1766755838082-bbb1a7</th>
            <th>worker-audit-jms<br />task-1766755838538-33d777</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="timestamp">2025-12-26 22:44</td>
            <td>
              <div class="agent-meta">
                <span class="status-badge status-badge--completed">å®Œäº†</span>
                <span class="agent-label">4xx=401 / 5xx=500 ã® TraceId ã¨ç›£æŸ»ãƒ­ã‚°åˆ°é”ã‚’è¨¼è·¡åŒ–ã€‚artifact åŒæ¢±ã€‚</span>
              </div>
              <div class="radar-wrap">
                <svg class="radar" data-scores="92,90,86,88,90,85" viewBox="0 0 120 120">
                  <polygon class="radar-base" fill="#eef3f4" stroke="#c4d3d7" stroke-width="1" />
                  <polygon class="radar-data" fill="#9bbbc2" opacity="0.7" stroke="#5c7f87" stroke-width="1" />
                </svg>
                <ul class="metric-list">
                  <li>å®Œäº†åº¦ 92ç‚¹: 401/500 ã¨ç›£æŸ»ãƒ­ã‚°æŠ½å‡ºãŒæƒã†ã€‚</li>
                  <li>è¨¼è·¡å“è³ª 90ç‚¹: headers/body/status + audit æŠ½å‡ºã‚’ä¿å­˜ã€‚</li>
                  <li>å†ç¾æ€§ 86ç‚¹: æ‰‹é †ãƒ»TraceIdãƒ»å¯¾è±¡APIãŒæ˜ç¢ºã€‚</li>
                  <li>é‹ç”¨é…æ…® 88ç‚¹: æ—¢å­˜èµ·å‹•ã‚’å‰æã«å†èµ·å‹•ãªã—ã€‚</li>
                  <li>æ‰‹é †æ˜ç¢ºæ€§ 90ç‚¹: ç›®çš„/æ‰‹é †/çµæœãŒæ•´ç†ã€‚</li>
                  <li>ãƒªã‚¹ã‚¯/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ 85ç‚¹: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä¼å­—ã€‚</li>
                </ul>
              </div>
              <div class="chip">ãƒ¡ãƒ€ãƒ«: ğŸ¥‡ / ã‚¹ã‚³ã‚¢: 88</div>
              <div class="link-list">
                æˆæœç‰©: <a href="../../src/server_modernized_gap_20251221/08_evidence_package/4xx5xx_TraceId_ç›£æŸ»åˆ°é”ç¢ºèª.md">è¨¼è·¡Markdown</a>,
                <a href="../../artifacts/error-audit/20251226T133210Z">artifact ä¸€å¼</a>
              </div>
              <details>
                <summary class="details-toggle">ã‚³ãƒŸãƒƒãƒˆ/å·®åˆ†</summary>
                <pre>Commit: 7b25ed32 Add audit trace extract for 4xx/5xx evidence
Commit: 73d7e91c Add evidence for 4xx/5xx TraceId audit reach
Diff: 9 files changed, 72 insertions (artifacts/error-audit, evidence md)</pre>
              </details>
              <details>
                <summary class="details-toggle">è©•ä¾¡ã‚³ãƒ¡ãƒ³ãƒˆ</summary>
                <pre>TraceId ã®ä¸€è‡´ãƒ»ç›£æŸ»ãƒ­ã‚°åˆ°é”ã®åŒæ–¹ã‚’ç¢ºèªã§ãã‚‹æ§‹æˆã€‚payload ã® httpStatus ã¨ status=failed ã‚’ç¤ºã—ã¦ãŠã‚Šè¦ä»¶ã«ä¸€è‡´ã€‚å†ç¾æ€§ã®ãŸã‚ curl ã‚³ãƒãƒ³ãƒ‰è©³ç´°ãŒã‚ã‚‹ã¨ã•ã‚‰ã«è‰¯ã„ã€‚</pre>
              </details>
            </td>
            <td>
              <div class="agent-meta">
                <span class="status-badge status-badge--completed">å®Œäº†</span>
                <span class="agent-label">4xx=400 / 5xx=500 ã® TraceId åˆ°é”ã‚’è¨˜éŒ²ã€‚artifact åŒæ¢±ã€‚</span>
              </div>
              <div class="radar-wrap">
                <svg class="radar" data-scores="88,85,82,86,85,80" viewBox="0 0 120 120">
                  <polygon class="radar-base" fill="#eef3f4" stroke="#c4d3d7" stroke-width="1" />
                  <polygon class="radar-data" fill="#9bbbc2" opacity="0.7" stroke="#5c7f87" stroke-width="1" />
                </svg>
                <ul class="metric-list">
                  <li>å®Œäº†åº¦ 88ç‚¹: 4xx/5xx ã¨ç›£æŸ»ãƒ­ã‚°åˆ°é”ã‚’ç¢ºèªã€‚</li>
                  <li>è¨¼è·¡å“è³ª 85ç‚¹: headers/response/status ã¨ audit TSV ã‚ã‚Šã€‚</li>
                  <li>å†ç¾æ€§ 82ç‚¹: TraceId å›ºå®šã ãŒ curl è©³ç´°ã¯ç°¡ç•¥ã€‚</li>
                  <li>é‹ç”¨é…æ…® 86ç‚¹: æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒŠå†åˆ©ç”¨ã‚’æ˜è¨˜ã€‚</li>
                  <li>æ‰‹é †æ˜ç¢ºæ€§ 85ç‚¹: å®Ÿæ–½æ¡ä»¶/çµæœãŒæ•´ç†ã€‚</li>
                  <li>ãƒªã‚¹ã‚¯/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ 80ç‚¹: ç«¶åˆã«ã‚ˆã‚‹èµ·å‹•å¤±æ•—è¨˜è¼‰ã‚ã‚Šã€‚</li>
                </ul>
              </div>
              <div class="chip">ãƒ¡ãƒ€ãƒ«: ğŸ¥ˆ / ã‚¹ã‚³ã‚¢: 84</div>
              <div class="link-list">
                æˆæœç‰©: <a href="../../src/server_modernized_gap_20251221/08_evidence_package/4xx5xx_TraceId_ç›£æŸ»åˆ°é”ç¢ºèª.md">è¨¼è·¡Markdown</a>,
                <a href="../../artifacts/audit-trace/20251226T133215Z">artifact ä¸€å¼</a>
              </div>
              <details>
                <summary class="details-toggle">ã‚³ãƒŸãƒƒãƒˆ/å·®åˆ†</summary>
                <pre>Commit: ec3fe7b3 Add evidence for 4xx/5xx traceId audit arrival
Diff: 9 files changed, 84 insertions (artifacts/audit-trace, evidence md)</pre>
              </details>
              <details>
                <summary class="details-toggle">è©•ä¾¡ã‚³ãƒ¡ãƒ³ãƒˆ</summary>
                <pre>HTTP 400/500 ã® TraceId åˆ°é”ã¯è¦ä»¶ã‚’æº€ãŸã™ã€‚setup å®Ÿè¡ŒãŒã‚³ãƒ³ãƒ†ãƒŠç«¶åˆã§ä¸­æ–­ã—ãŸç‚¹ã¯é‹ç”¨ãƒ¡ãƒ¢ã¨ã—ã¦æœ‰ç”¨ã ãŒã€å†ç¾æ‰‹é †ã¨ã—ã¦ curl ä¾‹ãŒã‚ã‚‹ã¨ã•ã‚‰ã«å¼·ã„ã€‚</pre>
              </details>
            </td>
            <td>
              <div class="agent-meta">
                <span class="status-badge status-badge--warning">ä¸€éƒ¨ä¸è¶³</span>
                <span class="agent-label">ç›£æŸ»ãƒ­ã‚°å‡ºåŠ›ã¯æœ¬æ–‡å†…ã«è¨˜è¼‰ã€‚artifact ãƒ•ã‚¡ã‚¤ãƒ«ãŒæœªåŒæ¢±ã€‚</span>
              </div>
              <div class="radar-wrap">
                <svg class="radar" data-scores="76,62,70,80,72,60" viewBox="0 0 120 120">
                  <polygon class="radar-base" fill="#eef3f4" stroke="#c4d3d7" stroke-width="1" />
                  <polygon class="radar-data" fill="#9bbbc2" opacity="0.7" stroke="#5c7f87" stroke-width="1" />
                </svg>
                <ul class="metric-list">
                  <li>å®Œäº†åº¦ 76ç‚¹: 4xx/5xx ã¨ audit è¡¨ç¤ºã¯ã‚ã‚‹ã€‚</li>
                  <li>è¨¼è·¡å“è³ª 62ç‚¹: artifact ã¨ã—ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ãŒãªã„ã€‚</li>
                  <li>å†ç¾æ€§ 70ç‚¹: curl ã¨ SQL ã¯ã‚ã‚‹ãŒæˆæœç‰©ãªã—ã€‚</li>
                  <li>é‹ç”¨é…æ…® 80ç‚¹: å†èµ·å‹•ãªã—ã‚’æ˜è¨˜ã€‚</li>
                  <li>æ‰‹é †æ˜ç¢ºæ€§ 72ç‚¹: æ‰‹é †ã¯ã‚ã‚‹ãŒ Evidence æ¬„ãŒä¸è¶³ã€‚</li>
                  <li>ãƒªã‚¹ã‚¯/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ 60ç‚¹: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰MD5ã‚’ç›´æ¥è¨˜è¼‰ã€‚</li>
                </ul>
              </div>
              <div class="chip">ãƒ¡ãƒ€ãƒ«: ğŸ¥‰ / ã‚¹ã‚³ã‚¢: 70</div>
              <div class="link-list">
                æˆæœç‰©: <a href="../../src/server_modernized_gap_20251221/08_evidence_package/4xx5xx_TraceId_ç›£æŸ»åˆ°é”ç¢ºèª.md">è¨¼è·¡Markdown</a>
              </div>
              <details>
                <summary class="details-toggle">ã‚³ãƒŸãƒƒãƒˆ/å·®åˆ†</summary>
                <pre>Commit: 60a4f6ac Add evidence for 4xx/5xx traceId audit reachability
Diff: 1 file changed, 72 insertions (evidence md only)</pre>
              </details>
              <details>
                <summary class="details-toggle">è©•ä¾¡ã‚³ãƒ¡ãƒ³ãƒˆ</summary>
                <pre>æœ¬æ–‡å†…ã®ãƒ­ã‚°å‡ºåŠ›ã¯ç¢ºèªã§ãã‚‹ãŒã€artifact ä¿å­˜ãŒãªãã€è¨¼è·¡åŒ–ã¨ã—ã¦ã¯å¼±ã„ã€‚å†ç¾æ€§ã¨ç›£æŸ»è¨¼è·¡ã®ä¿å…¨ã‚’æº€ãŸã™ãŸã‚ã€headers/body/status ã®ä¿å­˜ãŒå¿…è¦ã€‚</pre>
              </details>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <script>
      const charts = document.querySelectorAll(".radar");
      charts.forEach((svg) => {
        const scores = svg.dataset.scores.split(",").map((v) => Number(v.trim()));
        const center = 60;
        const maxR = 45;
        const angles = [-90, -30, 30, 90, 150, 210].map((deg) => (deg * Math.PI) / 180);
        const basePoints = angles
          .map((angle) => {
            const x = center + maxR * Math.cos(angle);
            const y = center + maxR * Math.sin(angle);
            return `${x.toFixed(1)},${y.toFixed(1)}`;
          })
          .join(" ");
        const dataPoints = angles
          .map((angle, idx) => {
            const r = maxR * (scores[idx] / 100);
            const x = center + r * Math.cos(angle);
            const y = center + r * Math.sin(angle);
            return `${x.toFixed(1)},${y.toFixed(1)}`;
          })
          .join(" ");
        svg.querySelector(".radar-base").setAttribute("points", basePoints);
        svg.querySelector(".radar-data").setAttribute("points", dataPoints);
      });
    </script>
  </body>
</html>
