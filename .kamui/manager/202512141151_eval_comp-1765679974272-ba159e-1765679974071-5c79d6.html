<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆ</title>
    <style>
      body { font-family: "Hiragino Sans", "Noto Sans JP", system-ui, -apple-system, BlinkMacSystemFont, sans-serif; line-height: 1.6; margin: 24px; background-color: #e9f0f2; color: #1f2a30; }
      .monitor-wrapper { max-width: 1180px; margin: 0 auto; padding: 32px; background: #ffffff; border: 1px solid #c4d3d7; }
      .monitor-header { display: flex; flex-direction: column; gap: 8px; margin-bottom: 24px; }
      .monitor-title { font-size: 26px; font-weight: 700; letter-spacing: 0.04em; color: #1f2a30; }
      .monitor-description { font-size: 14px; color: #3a4b53; }
      .scoreboard { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin: 12px 0 20px; }
      .score-card { padding: 12px; border: 1px solid #c4d3d7; background: #f6fafb; }
      .score-card h2 { margin: 0 0 6px; font-size: 18px; }
      .score-card .total { font-size: 24px; font-weight: 700; }
      .label { font-size: 12px; color: #3a4b53; }
      table.monitor-report { width: 100%; border-collapse: collapse; table-layout: fixed; background: #ffffff; border: 1px solid #c4d3d7; }
      col.timestamp-column { width: 180px; }
      col.agent-column { width: calc((100% - 180px) / 2); }
      th, td { border: 1px solid #c4d3d7; padding: 16px; vertical-align: top; background-color: #ffffff; }
      th { background: #d8e6e9; text-align: left; font-size: 13px; font-weight: 600; letter-spacing: 0.05em; text-transform: uppercase; color: #2c3a40; }
      tbody tr:nth-child(even) td { background-color: #eef3f4; }
      .agent-meta { display: block; margin-bottom: 8px; line-height: 1.5; }
      .status-badge { display: inline-block; font-size: 10px; font-weight: 600; letter-spacing: 0.02em; padding: 1px 6px; background: #d8e6e9; border: 1px solid #b8c9cd; color: #1f2a30; white-space: nowrap; line-height: 1.3; vertical-align: top; margin-right: 6px; }
      .status-badge--pass { background: #d9f4dd; border-color: #b2e4b9; }
      .status-badge--fail { background: #f8d7da; border-color: #f1aeb5; }
      .agent-label { display: inline; font-size: 13px; color: #3a4b53; }
      details { display: block; margin: 0; }
      details summary { list-style: none; cursor: pointer; }
      details[open] summary { margin-bottom: 12px; }
      .details-toggle { display: inline-flex; align-items: center; gap: 6px; cursor: pointer; font-weight: 500; font-size: 13px; color: #1f2a30; padding: 0; background: transparent; border: none; }
      .details-toggle::before { content: "â–¶"; font-size: 10px; transition: transform 160ms ease; display: inline-block; }
      details[open] .details-toggle::before { transform: rotate(90deg); }
      .radar { width: 220px; height: 190px; }
      .metric-list { margin: 8px 0 0; padding: 0; list-style: none; font-size: 12px; color: #2c3a40; }
      .metric-list li { margin: 2px 0; }
      pre { white-space: pre-wrap; word-break: break-word; margin: 0; font-size: 12px; line-height: 1.55; color: #1f2a30; background: #f2f6f7; border: 1px solid #c4d3d7; padding: 16px; }
      .snapshot-summary { margin-bottom: 12px; font-weight: 500; color: #2c3a40; }
    </style>
  </head>
  <body>
    <div class="monitor-wrapper">
      <header class="monitor-header">
        <h1 class="monitor-title">ModuleModelãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ‹¡å¼µ è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆ</h1>
        <p class="monitor-description">ã‚¿ã‚¹ã‚¯: task-1765679974272-ba159e / task-1765679974071-5c79d6 â€” ModuleModel beanBytes nullableåŒ–ã¨beanJsonè¿½åŠ ã®å®Ÿè£…æ¯”è¼ƒã€‚</p>
      </header>
      <div class="scoreboard">
        <div class="score-card">
          <h2>task-1765679974272-ba159e</h2>
          <div class="total">âŒ 185 / 600</div>
          <div class="label">ç†ç”±: ã‚¹ã‚­ãƒ¼ãƒç§»è¡Œã¨ãƒ‡ã‚³ãƒ¼ãƒ‰çµŒè·¯ãŒæœªæ•´å‚™ã§è¦ä»¶æœªé”ã€‚</div>
        </div>
        <div class="score-card">
          <h2>task-1765679974071-5c79d6</h2>
          <div class="total">ğŸ¥‰ 371 / 600</div>
          <div class="label">ç†ç”±: ç§»è¡Œã¨ãƒ‡ã‚³ãƒ¼ãƒ‰ã¯å®Ÿè£…ã™ã‚‹ã‚‚JSONã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãƒ»ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä¸è¶³ã€‚</div>
        </div>
      </div>
      <table class="monitor-report">
        <colgroup>
          <col class="timestamp-column" />
          <col class="agent-column" />
          <col class="agent-column" />
        </colgroup>
        <thead>
          <tr>
            <th>Timestamp</th>
            <th>codex / task-1765679974272-ba159e</th>
            <th>codex / task-1765679974071-5c79d6</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="timestamp">2025-12-14 11:51</td>
            <td>
              <div class="agent-meta"><span class="status-badge status-badge--fail">è©•ä¾¡</span><span class="agent-label">beanBytes nullable & beanJsonè¿½åŠ ã®ã¿ã€‚DBç§»è¡Œãƒ»ãƒ‡ã‚³ãƒ¼ãƒ‰çµŒè·¯æœªå¯¾å¿œã€‚</span></div>
              <svg class="radar" viewBox="0 0 220 190" data-metrics="35,30,60,40,10,10"></svg>
              <ul class="metric-list">
                <li>è¦ä»¶å……è¶³åº¦ 35: ã‚¹ã‚­ãƒ¼ãƒæ‹¡å¼µã®ã¿ã§èª­ã¿å‡ºã—/å¤‰æ›æœªå¯¾å¿œã€‚</li>
                <li>å¾Œæ–¹äº’æ›æ€§ 30: beanBytesã‚’nullableåŒ–ã—ãŸãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãªã—ã€ç§»è¡Œæ¬ å¦‚ã€‚</li>
                <li>ã‚³ãƒ¼ãƒ‰å“è³ª 60: ã‚·ãƒ³ãƒ—ãƒ«ã ãŒHibernateå‹æŒ‡å®šãªã—ã§DBå·®ç•°ãƒªã‚¹ã‚¯ã€‚</li>
                <li>è¨­è¨ˆå¦¥å½“æ€§ 40: converter/ã‚µãƒ¼ãƒ“ã‚¹æœªé€£å‹•ã§æ©Ÿèƒ½æœªå®Œæˆã€‚</li>
                <li>ãƒ†ã‚¹ãƒˆ/æ¤œè¨¼ 10: ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼è¨˜è¿°ãªã—ã€‚</li>
                <li>ç§»è¡Œãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ 10: Flywayç­‰ã®ç§»è¡Œæ‰‹å½“ãªã—ã€‚</li>
              </ul>
              <details class="snapshot-details">
                <summary class="details-toggle">å·®åˆ†ãƒ»ãƒ­ã‚°</summary>
                <pre>ã‚³ãƒŸãƒƒãƒˆ: f58ff922 feat: ModuleModelãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ‹¡å¼µ
å¤‰æ›´: common/src/main/java/open/dolphin/infomodel/ModuleModel.java
- beanBytes: @Column(nullable=false)å‰Šé™¤ã§nullableåŒ–
- beanJson TEXTè¿½åŠ ã€getter/setter/cloneã§ã‚³ãƒ”ãƒ¼
æ‡¸å¿µ: DBã‚¹ã‚­ãƒ¼ãƒæœªæ›´æ–°ã€ãƒ‡ã‚³ãƒ¼ãƒ‰çµŒè·¯æœªå¤‰æ›´</pre>
              </details>
            </td>
            <td>
              <div class="agent-meta"><span class="status-badge status-badge--pass">è©•ä¾¡</span><span class="agent-label">beanJsonå¯¾å¿œã¨Flywayç§»è¡Œã‚’è¿½åŠ ã€‚ãƒ‡ã‚³ãƒ¼ãƒ‰çµ±åˆã¯ã‚ã‚‹ãŒJSONç”Ÿæˆãªã—ã€‚</span></div>
              <svg class="radar" viewBox="0 0 220 190" data-metrics="75,70,78,68,10,70"></svg>
              <ul class="metric-list">
                <li>è¦ä»¶å……è¶³åº¦ 75: beanJsonåˆ—è¿½åŠ ãƒ»nullableåŒ–ãƒ»ãƒ‡ã‚³ãƒ¼ãƒ‰çµ±åˆã‚’å®Ÿè£…ã€‚</li>
                <li>å¾Œæ–¹äº’æ›æ€§ 70: beanBytesæ®‹å­˜ã—nullå¯ã€‚JSONå„ªå…ˆã§å¤±æ•—æ™‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç„¡ã—ãŒæ¸›ç‚¹ã€‚</li>
                <li>ã‚³ãƒ¼ãƒ‰å“è³ª 78: Hibernateå‹æ˜ç¤ºã¨cloneå¯¾å¿œã€‚ModelUtilsã®JSONå„ªå…ˆãŒå®‰å…¨æ€§ã«æ‡¸å¿µã€‚</li>
                <li>è¨­è¨ˆå¦¥å½“æ€§ 68: å¤‰æ›ã®èª­ã¿å´ã®ã¿ã§JSONæ›¸ãè¾¼ã¿çµŒè·¯æ¬ å¦‚ã€‚</li>
                <li>ãƒ†ã‚¹ãƒˆ/æ¤œè¨¼ 10: ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼è¨˜éŒ²ãªã—ã€‚</li>
                <li>ç§»è¡Œãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ 70: Flyway V0229ã§beanJsonè¿½åŠ ã¨NOT NULLè§£é™¤ã€‚</li>
              </ul>
              <details class="snapshot-details">
                <summary class="details-toggle">å·®åˆ†ãƒ»ãƒ­ã‚°</summary>
                <pre>ã‚³ãƒŸãƒƒãƒˆ: fc83b3d6 Add beanJson support to ModuleModel
ä¸»å¤‰æ›´:
- ModuleModel: beanBytesã‚’@JdbcTypeCode(SqlTypes.BINARY)/bytea, beanJson CLOB/textè¿½åŠ ã€‚
- ModelUtils: jsonDecode(ObjectMapper)è¿½åŠ ã—decodeModuleã§beanJsonå„ªå…ˆã€‚
- ModuleModelConverter: beanJson getterè¿½åŠ ã€‚
- KarteServiceBean: decodeBundleã§decodeModuleåˆ©ç”¨ã€‚
- Flyway V0229: d_module.beanBytes DROP NOT NULL + beanJson TEXTè¿½åŠ ã€‚
æ‡¸å¿µ: JSONãƒ‡ã‚³ãƒ¼ãƒ‰å¤±æ•—æ™‚ã®beanBytesãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãªã—ã€‚JSONä¿å­˜çµŒè·¯æœªå®Ÿè£…ã€‚</pre>
              </details>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <script>
      (function() {
        function drawRadar(svg) {
          const metrics = (svg.getAttribute('data-metrics') || '').split(',').map(Number);
          if (metrics.length !== 6) return;
          const cx = 110, cy = 95, r = 80;
          const axes = 6;
          const toPoint = (i, value) => {
            const angle = -Math.PI / 2 + (2 * Math.PI * i / axes);
            const radius = r * (value / 100);
            return [cx + radius * Math.cos(angle), cy + radius * Math.sin(angle)];
          };
          const bg = [];
          for (let i = 0; i < axes; i++) bg.push(toPoint(i, 100));
          const pg = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
          pg.setAttribute('points', bg.map(p => p.join(',')).join(' '));
          pg.setAttribute('fill', '#eef3f4');
          pg.setAttribute('stroke', '#c4d3d7');
          pg.setAttribute('stroke-width', '1');
          svg.appendChild(pg);
          const data = [];
          for (let i = 0; i < axes; i++) data.push(toPoint(i, metrics[i]));
          const dg = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
          dg.setAttribute('points', data.map(p => p.join(',')).join(' '));
          dg.setAttribute('fill', 'rgba(67, 138, 201, 0.35)');
          dg.setAttribute('stroke', '#2b6cb0');
          dg.setAttribute('stroke-width', '2');
          svg.appendChild(dg);
        }
        document.querySelectorAll('svg.radar').forEach(drawRadar);
      })();
    </script>
  </body>
</html>
