<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆ: 53 éšœå®³æ³¨å…¥ï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ/ã‚¹ã‚­ãƒ¼ãƒä¸ä¸€è‡´ï¼‰</title>
    <style>
      body {
        font-family: "Hiragino Sans", "Noto Sans JP", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        line-height: 1.6;
        margin: 24px;
        background-color: #e9f0f2;
        color: #1f2a30;
      }
      .monitor-wrapper {
        max-width: 1180px;
        margin: 0 auto;
        padding: 32px;
        background: #ffffff;
        border: 1px solid #c4d3d7;
      }
      .monitor-header {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 20px;
      }
      .monitor-title {
        font-size: 26px;
        font-weight: 700;
        letter-spacing: 0.04em;
        color: #1f2a30;
        margin: 0;
      }
      .monitor-description {
        font-size: 14px;
        color: #3a4b53;
        margin: 0;
      }
      .scoreboard {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin: 18px 0 24px;
      }
      .scorecard {
        border: 1px solid #c4d3d7;
        background: #ffffff;
        padding: 16px;
      }
      .scorecard h2 {
        font-size: 14px;
        margin: 0 0 10px 0;
        color: #2c3a40;
        letter-spacing: 0.03em;
      }
      .scorecard .total {
        font-size: 28px;
        font-weight: 800;
        letter-spacing: 0.02em;
        margin: 4px 0 8px;
      }
      .scorecard .meta {
        font-size: 12px;
        color: #3a4b53;
        margin: 0;
      }
      .note {
        font-size: 13px;
        color: #2c3a40;
        margin: 14px 0 0;
        padding: 10px 12px;
        border: 1px solid #c4d3d7;
        background: #eef3f4;
      }
      table.monitor-report {
        width: 100%;
        border-collapse: collapse;
        table-layout: fixed;
        background: #ffffff;
        border: 1px solid #c4d3d7;
      }
      col.timestamp-column {
        width: 180px;
      }
      col.agent-column {
        width: calc((100% - 180px) / 2);
      }
      th,
      td {
        border: 1px solid #c4d3d7;
        padding: 16px;
        vertical-align: top;
        background-color: #ffffff;
      }
      th {
        background: #d8e6e9;
        text-align: left;
        font-size: 13px;
        font-weight: 600;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        color: #2c3a40;
      }
      tbody tr:nth-child(even) td {
        background-color: #eef3f4;
      }
      details {
        display: block;
        margin: 0;
      }
      details summary {
        list-style: none;
      }
      details[open] summary {
        margin-bottom: 12px;
      }
      .details-toggle {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        cursor: pointer;
        font-weight: 500;
        font-size: 13px;
        color: #1f2a30;
        padding: 0;
        background: transparent;
        border: none;
      }
      .details-toggle::before {
        content: "â–¶";
        font-size: 10px;
        transition: transform 160ms ease;
        display: inline-block;
      }
      details[open] .details-toggle::before {
        transform: rotate(90deg);
      }
      .timestamp {
        font-weight: 600;
        color: #2c3a40;
        overflow-wrap: anywhere;
      }
      pre {
        white-space: pre-wrap;
        word-break: break-word;
        margin: 0;
        font-size: 12px;
        line-height: 1.55;
        color: #1f2a30;
        background: #f2f6f7;
        border: 1px solid #c4d3d7;
        padding: 16px;
      }
      .status-badge {
        display: inline-block;
        font-size: 10px;
        font-weight: 600;
        letter-spacing: 0.02em;
        padding: 1px 6px;
        background: #d8e6e9;
        border: 1px solid #b8c9cd;
        color: #1f2a30;
        white-space: nowrap;
        line-height: 1.3;
        vertical-align: top;
      }
      .status-badge--completed {
        background: #c3d4d8;
        border-color: #aabfc5;
      }
      .status-badge--pending {
        background: #e3edf0;
        border-color: #cdd9dd;
      }
      .agent-meta {
        display: block;
        margin-bottom: 8px;
        line-height: 1.5;
      }
      .agent-meta .status-badge {
        margin-right: 6px;
      }
      .agent-meta .agent-label {
        display: inline;
        font-size: 13px;
        color: #3a4b53;
      }

      .kpis {
        display: grid;
        grid-template-columns: 240px 1fr;
        gap: 14px;
        align-items: start;
        margin: 12px 0 14px;
      }
      .radar {
        border: 1px solid #c4d3d7;
        background: #ffffff;
        padding: 10px;
      }
      .radar svg {
        width: 100%;
        height: auto;
        display: block;
      }
      .kpi-list {
        margin: 0;
        padding-left: 18px;
        font-size: 12px;
        color: #2c3a40;
      }
      .kpi-list li {
        margin: 4px 0;
      }
      .pill {
        display: inline-block;
        font-size: 11px;
        padding: 1px 8px;
        border-radius: 999px;
        border: 1px solid #c4d3d7;
        background: #eef3f4;
        color: #2c3a40;
      }
      a {
        color: #1a5a75;
      }
      code {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <div class="monitor-wrapper">
      <header class="monitor-header">
        <h1 class="monitor-title">è©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆ: 53 éšœå®³æ³¨å…¥ï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ/500/ã‚¹ã‚­ãƒ¼ãƒä¸ä¸€è‡´/ã‚­ãƒ¥ãƒ¼æ»ç•™ï¼‰</h1>
        <p class="monitor-description">
          å¯¾è±¡ãƒ–ãƒ©ãƒ³ãƒ <code>task/task-1766077886052-3c7ddf</code> ã®ã‚³ãƒŸãƒƒãƒˆ/å·®åˆ†ã‚’ç²¾æŸ»ã—ã€æ©Ÿèƒ½åˆç†æ€§ãƒ»ç·»å¯†æ€§ã‚’ä¸­å¿ƒã«æ¡ç‚¹ã—ã¾ã™ï¼ˆç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚
        </p>
      </header>

      <section class="scoreboard" aria-label="åˆè¨ˆç‚¹">
        <div class="scorecard">
          <h2>claude code / task-1766077886052-3c7ddf</h2>
          <div class="total">521 / 600 ğŸ¥‡</div>
          <p class="meta">ç·åˆ: <span class="pill">87 / 100</span>ï¼ˆãƒ¡ãƒ€ãƒ«: <span class="pill">gold</span>ï¼‰</p>
          <p class="meta">HEAD: <code>eb2e8e59</code> / base(master): <code>d3462491</code> / æœªã‚³ãƒŸãƒƒãƒˆå¤‰æ›´: ãªã—</p>
        </div>
        <div class="scorecard">
          <h2>æ¯”è¼ƒå¯¾è±¡ãªã—</h2>
          <div class="total">0 / 600 âšªï¸</div>
          <p class="meta">ã“ã®è©•ä¾¡ã¯ 1 ãƒ–ãƒ©ãƒ³ãƒã®ã¿æŒ‡å®šã®ãŸã‚ã€æ¯”è¼ƒåˆ—ã¯å‚è€ƒæ ã§ã™ã€‚</p>
          <p class="meta">ï¼ˆä»»æ„ï¼‰åˆ¥ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ/åˆ¥ãƒ–ãƒ©ãƒ³ãƒãŒæç¤ºã•ã‚Œã‚Œã°å·®åˆ†æ¯”è¼ƒã«æ›´æ–°ã§ãã¾ã™ã€‚</p>
        </div>
      </section>

      <p class="note">
        æ³¨æ„: æˆæœç‰©ãƒªãƒ³ã‚¯ã¯ <code>.worktrees/task-1766077886052-3c7ddf</code> å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ã¾ã™ã€‚worktree ã‚’å‰Šé™¤ã™ã‚‹ã¨ãƒªãƒ³ã‚¯ãŒåˆ‡ã‚Œã¾ã™ã€‚
      </p>

      <table class="monitor-report">
        <colgroup>
          <col class="timestamp-column" />
          <col class="agent-column" />
          <col class="agent-column" />
        </colgroup>
        <thead>
          <tr>
            <th>Timestamp</th>
            <th>claude code / task-1766077886052-3c7ddf</th>
            <th>æ¯”è¼ƒå¯¾è±¡ãªã—</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="timestamp">2025-12-19 02:31</td>
            <td>
              <div class="agent-meta">
                <span class="status-badge status-badge--completed">è©•ä¾¡å®Œäº†</span>
                <span class="agent-label">MSW ã«ã‚ˆã‚‹éšœå®³æ³¨å…¥ï¼ˆtimeout/500/schema mismatch/queue stallï¼‰ã‚’è¿½åŠ ã—ã€æ‰‹å‹•æ‰‹é †ãƒ»E2E ã‚’æ•´å‚™ã€‚</span>
              </div>

              <div class="kpis">
                <div
                  class="radar"
                  data-radar
                  data-title="6æŒ‡æ¨™ï¼ˆå„100ç‚¹ï¼‰"
                  data-scores="90,82,88,85,84,92"
                  data-labels="æ©Ÿèƒ½åˆç†æ€§,ç·»å¯†æ€§,ã‚³ãƒ¼ãƒ‰å“è³ª,ãƒ†ã‚¹ãƒˆ/æ¤œè¨¼,è¨¼è·¡/é‹ç”¨,ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ"
                >
                  <svg viewBox="0 0 240 220" role="img" aria-label="6æŒ‡æ¨™ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆï¼ˆclaude codeï¼‰">
                    <defs>
                      <style>
                        .grid { fill: none; stroke: #c4d3d7; stroke-width: 1; }
                        .axis { stroke: #b8c9cd; stroke-width: 1; }
                        .shape { fill: rgba(26, 90, 117, 0.22); stroke: #1a5a75; stroke-width: 2; }
                        .label { font: 11px "Hiragino Sans", "Noto Sans JP", system-ui, sans-serif; fill: #2c3a40; }
                        .title { font: 12px "Hiragino Sans", "Noto Sans JP", system-ui, sans-serif; fill: #1f2a30; font-weight: 700; }
                      </style>
                    </defs>
                    <text class="title" x="10" y="18">6æŒ‡æ¨™ï¼ˆå„100ç‚¹ï¼‰</text>
                    <g data-grid></g>
                    <g data-axis></g>
                    <polygon class="shape" data-shape points=""></polygon>
                    <g data-labels></g>
                  </svg>
                </div>
                <ol class="kpi-list" aria-label="æŒ‡æ¨™å†…è¨³">
                  <li>æ©Ÿèƒ½åˆç†æ€§ 90ç‚¹: è¦ä»¶4ç¨®ã‚’ MSW/ãƒ˜ãƒƒãƒ€ãƒ¼ã§ä¸€æ‹¬æ³¨å…¥ã—ã€UI æ“ä½œã‹ã‚‰åˆ‡æ›¿ã§ãã‚‹ã€‚</li>
                  <li>ç·»å¯†æ€§ 82ç‚¹: ä¸»è¦ç¶²ç¾…ã¯ååˆ†ã€‚ãŸã ã— MSW ç„¡åŠ¹æ™‚ã®ãƒ˜ãƒƒãƒ€ãƒ¼ä»˜ä¸ã‚¬ãƒ¼ãƒ‰ç­‰ã«æ”¹å–„ä½™åœ°ã€‚</li>
                  <li>ã‚³ãƒ¼ãƒ‰å“è³ª 88ç‚¹: 60s ä¸Šé™ãƒ»ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ãªã©å …å®Ÿã€‚å…±é€šåŒ–ï¼ˆparseFaultSpec é‡è¤‡ï¼‰ã™ã‚‹ã¨ã•ã‚‰ã«è‰¯ã„ã€‚</li>
                  <li>ãƒ†ã‚¹ãƒˆ/æ¤œè¨¼ 85ç‚¹: Playwright ã§4ãƒ‘ã‚¿ãƒ¼ãƒ³ç¢ºèªã€‚ãŸã ã—ãƒ‰ãƒ©ãƒ•ãƒˆä¿æŒãƒ»åŒ»ç™‚è¨˜éŒ²å´ã®å¾©å¸°ã¾ã§è‡ªå‹•åŒ–ã™ã‚‹ã¨å¼·ã„ã€‚</li>
                  <li>è¨¼è·¡/é‹ç”¨ 84ç‚¹: RUN_ID ã¨ artifacts å°ç·šã¯æ˜è¨˜ã€‚RUN_ID æœªæŒ‡å®šæ™‚ã® <code>unknown-run-id</code> ã«ãªã‚Šå¾—ã‚‹ç‚¹ã¯æ³¨æ„ã€‚</li>
                  <li>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ 92ç‚¹: æ‰‹é †æ›¸ãƒ»å®Ÿè£…ãƒ­ã‚°ãƒ»DOC_STATUSãƒ»ãƒãƒ–æ›´æ–°ãŒæƒã„ã€è¿½è·¡æ€§ãŒé«˜ã„ã€‚</li>
                </ol>
              </div>

              <details class="snapshot-details">
                <summary class="details-toggle">ä»•äº‹ã®æ¦‚è¦ï¼ˆè§£æ±ºã—ãŸèª²é¡Œ / å®Ÿç¾ã—ãŸæ©Ÿèƒ½ï¼‰</summary>
                <pre>
ç›®çš„:
- Charts ã®å¤–æ¥ãƒ•ãƒ­ãƒ¼ã§ timeout / 500 / ã‚¹ã‚­ãƒ¼ãƒä¸ä¸€è‡´ / ã‚­ãƒ¥ãƒ¼æ»ç•™ ã‚’æ„å›³çš„ã«å†ç¾ã—ã€
  UI ãŒã€Œè½ã¡ãšã«èª¬æ˜ã§ãã‚‹ã€ã“ã¨ã¨ã€è§£é™¤å¾Œã«å¾©å¸°ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªå¯èƒ½ã«ã™ã‚‹ã€‚

å®Ÿç¾:
- å…±é€šãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã§ x-msw-fault / x-msw-delay-ms ã‚’ä»˜ä¸ã—ã€MSW ãƒãƒ³ãƒ‰ãƒ©å´ã§ 4 ç¨®éšœå®³ã‚’æ³¨å…¥ã€‚
- /outpatient-mock ã‹ã‚‰éšœå®³æ³¨å…¥ã‚’ UI æ“ä½œã§åˆ‡æ›¿ï¼ˆlocalStorage æ°¸ç¶šï¼‰ã€‚
- Playwright(MSWãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«) ã§ 4 ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã€Œã‚¨ãƒ©ãƒ¼è¡¨ç¤ºâ†’è§£é™¤â†’å¾©å¸°ã€ã‚’è‡ªå‹•ç¢ºèªã€‚
                </pre>
              </details>

              <details class="snapshot-details">
                <summary class="details-toggle">æˆæœç‰©ãƒªãƒ³ã‚¯ï¼ˆworktreeå‚ç…§ï¼‰</summary>
                <pre>
æ‰‹é †æ›¸:
- ../../.worktrees/task-1766077886052-3c7ddf/src/charts_production_outpatient/quality/53_éšœå®³æ³¨å…¥_ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ_ã‚¹ã‚­ãƒ¼ãƒä¸ä¸€è‡´.md

å®Ÿè£…ãƒ­ã‚°:
- ../../.worktrees/task-1766077886052-3c7ddf/docs/web-client/planning/phase2/logs/20251218T171651Z-charts-fault-injection.md

ä¸»è¦å®Ÿè£…:
- ../../.worktrees/task-1766077886052-3c7ddf/web-client/src/libs/http/header-flags.ts
- ../../.worktrees/task-1766077886052-3c7ddf/web-client/src/features/outpatient/OutpatientMockPage.tsx
- ../../.worktrees/task-1766077886052-3c7ddf/web-client/src/mocks/handlers/outpatient.ts
- ../../.worktrees/task-1766077886052-3c7ddf/web-client/src/mocks/handlers/orcaQueue.ts

E2E:
- ../../.worktrees/task-1766077886052-3c7ddf/tests/e2e/charts-fault-injection.msw.spec.ts
                </pre>
              </details>

              <details class="snapshot-details">
                <summary class="details-toggle">ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚° / å·®åˆ†ã‚µãƒãƒª</summary>
                <pre>
commit:
eb2e8e59 (HEAD -> task/task-1766077886052-3c7ddf) charts: add MSW fault injection (timeout/500/schema mismatch/queue stall)

diffstat (master..HEAD):
10 files changed, 766 insertions(+), 15 deletions(-)
M  docs/web-client/README.md
M  docs/web-client/planning/phase2/DOC_STATUS.md
A  docs/web-client/planning/phase2/logs/20251218T171651Z-charts-fault-injection.md
A  src/charts_production_outpatient/quality/53_éšœå®³æ³¨å…¥_ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ_ã‚¹ã‚­ãƒ¼ãƒä¸ä¸€è‡´.md
A  tests/e2e/charts-fault-injection.msw.spec.ts
M  web-client/src/features/outpatient/OutpatientMockPage.tsx
M  web-client/src/libs/http/header-flags.ts
M  web-client/src/mocks/handlers/index.ts
A  web-client/src/mocks/handlers/orcaQueue.ts
M  web-client/src/mocks/handlers/outpatient.ts
                </pre>
              </details>

              <details class="snapshot-details">
                <summary class="details-toggle">è©•ä¾¡ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆè‰¯ã„ç‚¹ / æ”¹å–„ææ¡ˆï¼‰</summary>
                <pre>
è‰¯ã„ç‚¹:
- éšœå®³æ³¨å…¥ã‚’ã€ŒHTTP å¤±æ•—ï¼ˆ504/500ï¼‰ã€ã¨ã€Œã‚¢ãƒ—ãƒªå±¤ã‚¹ã‚­ãƒ¼ãƒä¸ä¸€è‡´ï¼ˆ200 + ERROR_*ï¼‰ã€ã«åˆ†ã‘ã¦å†ç¾ã§ãã€ç¾å®Ÿã®éšœå®³ã®åˆ‡ã‚Šåˆ†ã‘ã«ä½¿ãˆã‚‹ã€‚
- /outpatient-mock ã® UI ã‹ã‚‰å³æ™‚ã«åˆ‡æ›¿ã§ãã€æ‰‹å‹•ç¢ºèªã®å†ç¾æ€§ãŒé«˜ã„ï¼ˆlocalStorage ã«ä¿æŒï¼‰ã€‚
- ORCA ã‚­ãƒ¥ãƒ¼æ»ç•™ã¯ lastDispatchAt ã‚’éå»ã«å€’ã™ã ã‘ã§å†ç¾ã—ã¦ãŠã‚Šã€æ—¢å­˜ã®æ»ç•™æ¤œçŸ¥ãƒ­ã‚¸ãƒƒã‚¯ã¨æ•´åˆã—ã‚„ã™ã„ã€‚
- docs/ ã¨ DOC_STATUS ã¾ã§æ›´æ–°ã•ã‚Œã€RUN_ID ã¨è¨¼è·¡ã®å°ç·šãŒä¿ãŸã‚Œã¦ã„ã‚‹ã€‚

æ”¹å–„ææ¡ˆï¼ˆç·»å¯†æ€§å‘ä¸Šï¼‰:
- MSW ç„¡åŠ¹æ™‚ï¼ˆVITE_DISABLE_MSW=1 ã‚„ Stage æ¥ç¶šï¼‰ã« x-msw-fault / x-msw-delay-ms ã‚’ä»˜ä¸ã—ãªã„ã‚¬ãƒ¼ãƒ‰ãŒã‚ã‚‹ã¨å®‰å¿ƒã€‚
  ä¾‹: resolveHeaderFlags/buildHeaderOverrides å´ã§ MSW æœ‰åŠ¹æ¡ä»¶ã‚’è¦‹ã¦æŠ‘æ­¢ã™ã‚‹ã€ã¾ãŸã¯ msw=1 ã®ã¨ãã®ã¿æ³¨å…¥ã™ã‚‹ã€‚
- parseFaultSpec ãŒ outpatient.ts ã¨ orcaQueue.ts ã§é‡è¤‡ã—ã¦ã„ã‚‹ãŸã‚ã€å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£åŒ–ã™ã‚‹ã¨ä¿å®ˆæ€§ãŒä¸ŠãŒã‚‹ã€‚
- E2E ã§ã€ŒåŒ»ç™‚è¨˜éŒ²å´ã®å¾©å¸°ï¼ˆå†å–å¾—ã§ã‚¨ãƒ©ãƒ¼è§£æ¶ˆï¼‰ã€ã‚„ã€Œãƒ‰ãƒ©ãƒ•ãƒˆä¿æŒã€ã¾ã§è‡ªå‹•åŒ–ã§ãã‚‹ã¨è¦ä»¶é”æˆã®å¼·åº¦ãŒä¸ŠãŒã‚‹ã€‚
                </pre>
              </details>
            </td>
            <td>
              <div class="agent-meta">
                <span class="status-badge status-badge--pending">è©•ä¾¡å¯¾è±¡å¤–</span>
                <span class="agent-label">ã“ã®åˆ—ã¯æ¯”è¼ƒç”¨ã®ç©ºæ ã§ã™ã€‚</span>
              </div>
              <div class="kpis">
                <div class="radar" data-radar data-title="6æŒ‡æ¨™ï¼ˆå„100ç‚¹ï¼‰" data-scores="0,0,0,0,0,0" data-labels="æ©Ÿèƒ½åˆç†æ€§,ç·»å¯†æ€§,ã‚³ãƒ¼ãƒ‰å“è³ª,ãƒ†ã‚¹ãƒˆ/æ¤œè¨¼,è¨¼è·¡/é‹ç”¨,ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ">
                  <svg viewBox="0 0 240 220" role="img" aria-label="6æŒ‡æ¨™ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆï¼ˆæ¯”è¼ƒå¯¾è±¡ãªã—ï¼‰">
                    <defs>
                      <style>
                        .grid { fill: none; stroke: #c4d3d7; stroke-width: 1; }
                        .axis { stroke: #b8c9cd; stroke-width: 1; }
                        .shape { fill: rgba(150, 150, 150, 0.15); stroke: #6b7b82; stroke-width: 2; }
                        .label { font: 11px "Hiragino Sans", "Noto Sans JP", system-ui, sans-serif; fill: #2c3a40; }
                        .title { font: 12px "Hiragino Sans", "Noto Sans JP", system-ui, sans-serif; fill: #1f2a30; font-weight: 700; }
                      </style>
                    </defs>
                    <text class="title" x="10" y="18">6æŒ‡æ¨™ï¼ˆå„100ç‚¹ï¼‰</text>
                    <g data-grid></g>
                    <g data-axis></g>
                    <polygon class="shape" data-shape points=""></polygon>
                    <g data-labels></g>
                  </svg>
                </div>
                <ol class="kpi-list">
                  <li>è©•ä¾¡å¯¾è±¡ãªã—ï¼ˆ0ç‚¹æ‰±ã„ï¼‰</li>
                </ol>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <script>
      (function () {
        function clamp01(v) {
          if (Number.isNaN(v)) return 0;
          return Math.max(0, Math.min(1, v));
        }

        function polarToXY(cx, cy, radius, angleRad) {
          return { x: cx + radius * Math.cos(angleRad), y: cy + radius * Math.sin(angleRad) };
        }

        function renderRadar(el) {
          var labels = (el.getAttribute("data-labels") || "").split(",").map(function (s) { return s.trim(); }).filter(Boolean);
          var scores = (el.getAttribute("data-scores") || "").split(",").map(function (s) { return Number(s.trim()); });
          while (scores.length < labels.length) scores.push(0);
          scores = scores.slice(0, labels.length);

          var svg = el.querySelector("svg");
          if (!svg) return;
          var grid = svg.querySelector("[data-grid]");
          var axis = svg.querySelector("[data-axis]");
          var shape = svg.querySelector("[data-shape]");
          var labelGroup = svg.querySelector("[data-labels]");
          if (!grid || !axis || !shape || !labelGroup) return;

          grid.innerHTML = "";
          axis.innerHTML = "";
          labelGroup.innerHTML = "";

          var cx = 120;
          var cy = 120;
          var maxR = 78;
          var count = Math.max(3, labels.length || 6);
          var start = -Math.PI / 2; // ä¸Šã‹ã‚‰é–‹å§‹

          // ã‚°ãƒªãƒƒãƒ‰ï¼ˆ3å±¤ï¼‰
          [0.33, 0.66, 1].forEach(function (t) {
            var pts = [];
            for (var i = 0; i < count; i++) {
              var a = start + (i * 2 * Math.PI) / count;
              var p = polarToXY(cx, cy, maxR * t, a);
              pts.push(p.x.toFixed(2) + "," + p.y.toFixed(2));
            }
            var poly = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
            poly.setAttribute("class", "grid");
            poly.setAttribute("points", pts.join(" "));
            grid.appendChild(poly);
          });

          // è»¸ã¨ãƒ©ãƒ™ãƒ«
          for (var i = 0; i < count; i++) {
            var a = start + (i * 2 * Math.PI) / count;
            var p = polarToXY(cx, cy, maxR, a);
            var line = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line.setAttribute("class", "axis");
            line.setAttribute("x1", String(cx));
            line.setAttribute("y1", String(cy));
            line.setAttribute("x2", String(p.x));
            line.setAttribute("y2", String(p.y));
            axis.appendChild(line);

            var label = labels[i] || "æŒ‡æ¨™" + (i + 1);
            var lp = polarToXY(cx, cy, maxR + 22, a);
            var text = document.createElementNS("http://www.w3.org/2000/svg", "text");
            text.setAttribute("class", "label");
            text.setAttribute("x", String(lp.x));
            text.setAttribute("y", String(lp.y));
            text.setAttribute("text-anchor", lp.x >= cx ? "start" : "end");
            text.setAttribute("dominant-baseline", lp.y >= cy ? "hanging" : "auto");
            text.textContent = label;
            labelGroup.appendChild(text);
          }

          // å½¢çŠ¶
          var pts2 = [];
          for (var i = 0; i < count; i++) {
            var s = clamp01((scores[i] || 0) / 100);
            var a = start + (i * 2 * Math.PI) / count;
            var p = polarToXY(cx, cy, maxR * s, a);
            pts2.push(p.x.toFixed(2) + "," + p.y.toFixed(2));
          }
          shape.setAttribute("points", pts2.join(" "));
        }

        document.querySelectorAll("[data-radar]").forEach(renderRadar);
      })();
    </script>
  </body>
</html>

