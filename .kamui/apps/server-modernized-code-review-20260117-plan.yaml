ganttConfig:
  defaultView: day
  startDate: 2026-01-18
  showFilters: true
  filters:
    priorities:
      High: true
      Medium: true
      Low: true
    statuses:
      completed: true
      in_progress: true
      not_started: true
    showDependencies: true
labels:
  dayNames:
    - 日
    - 月
    - 火
    - 水
    - 木
    - 金
    - 土
  priorities:
    high: 高
    medium: 中
    low: 低
  statuses:
    completed: 完了
    inProgress: 進行中
    notStarted: 未開始
  buttons:
    filter: フィルター
    previousPeriod: 前へ
    nextPeriod: 次へ
  filterPanel:
    priorities: 優先度
    statuses: ステータス
    dependencies: 依存関係
    showDependencies: 依存関係を表示
    tasksCount: タスク数
  tooltipFields:
    startDate: 開始日
    duration: 期間
    priority: 優先度
    status: ステータス
    progress: 進捗
    agent: エージェント
    details: 詳細
    prerequisites: 前提タスク
    nextTasks: Next Tasks
filters:
  priorities:
    High: true
    Medium: true
    Low: true
  statuses:
    completed: true
    in_progress: true
    not_started: true
  showDependencies: true
src:
  structure.yaml:
    content: |-
      本計画は、server-modernized のコードレビュー未解決項目（dataSourceTransition 正規化、recordsReturned 追加、runId 優先化）をまとめて解消するための実装・検証ガントです。
      レビュー結果の指摘を前提に、修正→再検証→証跡保存の流れを最短で完結させます。

      参照ドキュメント: docs/server-modernization/server-modernized-code-review-20260117.md
      RUN_ID: 20260117T231022Z
    agent選定理由: サーバー実装と検証を単一ストリームで完結させるため codex を採用。
    api選定理由: 既存の OpenDolphin/ORCA API 経由で完結するため追加 API は不要。
    dependency: []
    agent: codex
    api: []
    ganttConfig:
      defaultView: day
      startDate: 2026-01-18
      showFilters: true
      filters:
        priorities:
          High: true
          Medium: true
          Low: true
        statuses:
          completed: true
          in_progress: true
          not_started: true
        showDependencies: true
      labels:
        dayNames:
          - 日
          - 月
          - 火
          - 水
          - 木
          - 金
          - 土
        priorities:
          high: 高
          medium: 中
          low: 低
        statuses:
          completed: 完了
          inProgress: 進行中
          notStarted: 未開始
        buttons:
          filter: フィルター
          previousPeriod: 前へ
          nextPeriod: 次へ
        filterPanel:
          priorities: 優先度
          statuses: ステータス
          dependencies: 依存関係
          showDependencies: 依存関係を表示
          tasksCount: タスク数
        tooltipFields:
          startDate: 開始日
          duration: 期間
          priority: 優先度
          status: ステータス
          progress: 進捗
          agent: エージェント
          details: 詳細
          prerequisites: 前提タスク
          nextTasks: Next Tasks
  server_modernized_code_review_20260117:
    00_context:
      00_RUN_IDと参照チェーン.md:
        content: |-
          # 00 RUN_ID と参照チェーン

          - RUN_ID: 20260117T231022Z
          - 参照順: `docs/DEVELOPMENT_STATUS.md` → `docs/server-modernization/server-modernized-code-review-20260117.md` → `server-modernized/src` → `web-client/src` → 本ガント
          - 目的: 未解決 3 項目の修正と再検証を単一リリースで完結させる
        dependency: []
        agent: codex
        api: []
        priority: High
        status: completed
        progress: 100
        schedule:
          start: 2026-01-18T00:00:00.000Z
          days: 0.25
    01_server_modernized:
      メタ正規化と共通メタ追加.md:
        content: |-
          # メタ正規化と共通メタ追加

          ## 対応範囲
          - dataSourceTransition を server に正規化（real/stub を UI 判定から分離）
          - recordsReturned を OrcaApiResponse に追加し list 系で集計
          - 監査 details に recordsReturned と orcaMode を格納

          ## 対象ファイル（例）
          - server-modernized/src/main/java/open/dolphin/orca/rest/AbstractOrcaWrapperResource.java
          - server-modernized/src/main/java/open/dolphin/rest/dto/orca/OrcaApiResponse.java
          - server-modernized/src/main/java/open/dolphin/rest/dto/orca/OrcaAppointmentListResponse.java
          - server-modernized/src/main/java/open/dolphin/rest/dto/orca/VisitPatientListResponse.java

          ## 完了条件
          - /orca/appointments/list と /orca/visits/list の dataSourceTransition が server で統一
          - recordsReturned が両 API と監査 details に含まれる
        dependency:
          - src/server_modernized_code_review_20260117/00_context/00_RUN_IDと参照チェーン.md
        agent: codex
        api:
          - OpenDolphin Native API
          - ORCA Official API
        priority: High
        status: not_started
        progress: 0
        schedule:
          start: 2026-01-18T01:00:00.000Z
          days: 1
    02_runid_policy:
      runIdヘッダー優先化と上書き防止.md:
        content: |-
          # runIdヘッダー優先化と上書き防止

          ## 対応範囲
          - X-Run-Id がある場合はそれを採用、無い場合のみ UTC 発番
          - OrcaWrapperService#enrich が既存 runId を上書きしない
          - audit details が resolveRunId を参照する

          ## 対象ファイル（例）
          - server-modernized/src/main/java/open/dolphin/orca/rest/AbstractOrcaWrapperResource.java
          - server-modernized/src/main/java/open/dolphin/orca/service/OrcaWrapperService.java

          ## 完了条件
          - UI から渡した runId がレスポンス/監査で維持される
          - 固定値 RUN_ID は診断用途に限定される
        dependency:
          - src/server_modernized_code_review_20260117/01_server_modernized/メタ正規化と共通メタ追加.md
        agent: codex
        api:
          - OpenDolphin Native API
        priority: High
        status: not_started
        progress: 0
        schedule:
          start: 2026-01-19T03:00:00.000Z
          days: 0.75
    03_validation:
      再検証と証跡作成.md:
        content: |-
          # 再検証と証跡作成

          ## 実施内容
          - /orca/appointments/list, /orca/visits/list のレスポンスメタ確認
          - 監査ログ（JMS）の dataSourceTransition / recordsReturned / runId を確認
          - artifacts/api-architecture-consolidation/<RUN_ID>/ に再検証ログを保存

          ## 完了条件
          - 旧互換ラッパー未呼び出しの再確認ログが揃う
          - docs/server-modernization/server-modernized-code-review-20260117.md の未解決項目が全て解消したと判断できる
        dependency:
          - src/server_modernized_code_review_20260117/02_runid_policy/runIdヘッダー優先化と上書き防止.md
        agent: codex
        api:
          - OpenDolphin Native API
          - ORCA Official API
        priority: Medium
        status: not_started
        progress: 0
        schedule:
          start: 2026-01-20T00:00:00.000Z
          days: 0.5
