# ドキュメント棚卸しステータス（Phase 2）

Web クライアントおよびサーバーモダナイズで参照する資料を「すぐ使うものだけを見える化」するための台帳。月次の Phase2 定例（毎月第1火曜）で更新し、更新後は `docs/web-client/README.md` の該当セクションにリンクを追記する。

## ステータス定義
- **Active**: 直近 30 日以内に更新 or 今後 30 日以内に作業予定がある。リンク切れがないことを確認し、担当者を必ず明記。
- **Dormant**: 31〜180 日間更新がなく、参照頻度が低下。次に参照する可能性があるイベント（例: リリース、検証ウィンドウ）を備考に記載し、担当者レビュー期限を設定。
- **Archive**: 180 日以上更新がなく、現行フローから切り離された資料。`docs/archive/<YYYYQn>/` 配下へ移動し、元ファイルにはスタブを残す。

## 棚卸し手順
1. `git log -1 --format='%cs %h' <path>` で最終更新日とコミットを記録。
2. `rg -n '<file name>' docs -g"*.md"` で参照元件数を確認し、Active 化が必要か判断。
3. ステータス変更時は本ファイルの表と `docs/web-client/README.md` / 関係する README を同時に更新。
4. Archive へ移動する場合は `docs/archive/<YYYYQn>/README.md` に理由と復活条件を追記し、PR 説明欄に「Archive Move」を付記。

## トラッキング対象（2025-11-07 更新）
| ドキュメント | スコープ | ステータス | 最終レビュー | 備考 / 次アクション |
| --- | --- | --- | --- | --- |
| [`docs/web-client/README.md`](../../README.md) | Web クライアント | Active | 2025-11-07 | 再構成済み。週次でリンク検査を実施し、Phase2 INDEX と同期する。
| [`docs/web-client/architecture/REPOSITORY_OVERVIEW.md`](../../architecture/REPOSITORY_OVERVIEW.md) | Web クライアント | Active | 2025-11-12 | Modules 節へ共通モジュール共有方針と `-jakarta` classifier 併産手順を追記。`patches/common_shared_policy.md` へ根拠リンクを集約し、質問対応フローを一本化。 |
| [`docs/web-client/architecture/WEB_CLIENT_REQUIREMENTS.md`](../../architecture/WEB_CLIENT_REQUIREMENTS.md) | Web クライアント | Active | 2025-11-12 | §5.4 に facility=9001/`userName=9001:doctor1` を前提とした公開/共有タブの切替ガードと 403 フォールバック記載を追加し、§14.6 に `GET /stamp/tree/{facility}/{public|shared|published}`（RUN_ID=`20251113Tstamp{Public,Shared,Published}PlanZ1`）の API 定義を追記。`TRACEID_JMS_RUNBOOK.md` Appendix A.4 / `domain-transaction-parity.md` Appendix A.5 とリンク済み。 |
| [`docs/server-modernization/phase2/domains/RESERVATION_BATCH_MIGRATION_NOTES.md`](../../../server-modernization/phase2/domains/RESERVATION_BATCH_MIGRATION_NOTES.md) | モダナイズ/連携 | Active | 2025-11-09 | §8 に Legacy WildFly10 復旧ログ／`ServerInfoResource` 証跡を追記し、CLAIM/DIAGNOSIS 検証ログから新規 artifacts へリンク済み。次回は ClaimSender/DiagnosisSender の修正結果と突合する。 |
| [`docs/server-modernization/phase2/operations/WORKER0_MESSAGING_BACKLOG.md`](../../../server-modernization/phase2/operations/WORKER0_MESSAGING_BACKLOG.md) | モダナイズ運用 | Archive予定 | 2025-11-07 | 内容は RESERVATION メモへ統合済み。スタブのみ残っているため 2025Q4 Archive へ移動。
| [`docs/server-modernization/phase2/notes/static-analysis-plan.md`](../../../server-modernization/phase2/notes/static-analysis-plan.md) | 共通（Ops） | Dormant | 2025-11-07 | Ops Runbook へ必要箇所を移したら Archive。Slack/PagerDuty 設定は Runbook 側で保守。
| [`docs/server-modernization/phase2/notes/common-dto-diff-A-M.md`](../../../server-modernization/phase2/notes/common-dto-diff-A-M.md) / [`N-Z`](../../../server-modernization/phase2/notes/common-dto-diff-N-Z.md) | 共通 DTO | Archive予定 | 2025-11-07 | DTO 差分は CSV へ抜粋し `docs/archive/2025Q4/dto-diff/` へ移動予定。Legacy 互換確認時のみ参照。
| [`docs/server-modernization/phase2/SERVER_MODERNIZED_STARTUP_BLOCKERS.md`](../../../server-modernization/phase2/SERVER_MODERNIZED_STARTUP_BLOCKERS.md) | モダナイズ運用 | Active | 2025-11-09 | Legacy WildFly10 の `DB_HOST` 衝突（ORCA ネットワークの `db` alias）を Appendix として追加し、Compose/CLI 差分と `jboss-cli` 証跡へのリンクを整理。Blocking Issue 解消後に Dormant 評価。 |
| [`docs/server-modernization/phase2/operations/TRACEID_JMS_RUNBOOK.md`](../../../server-modernization/phase2/operations/TRACEID_JMS_RUNBOOK.md) | Network/Build | Active | 2025-11-12 | Appendix A.4 を Stamp 公開系 GET（RUN_ID=`20251113Tstamp{Public,Shared,Published}PlanZ1`）向けに再編し、`PARITY_HEADER_FILE=tmp/parity-headers/stamp_tree_<variation>_<RUN_ID>.headers`（`userName=9001:doctor1`）／helper コマンド（`--network legacy-vs-modern_default`）／`logs/send_parallel_request.log`／JMS before/after の保存先を定義。facility ミスマッチ 403（`RUN_ID=20251113TstampPublicPlanZ4`）の WARN ログ採取手順も追記した。 |
| [`docs/server-modernization/phase2/operations/POSTGRES_BASELINE_RESTORE.md`](../../../server-modernization/phase2/operations/POSTGRES_BASELINE_RESTORE.md) | モダナイズ/DB | Active | 2025-11-09 | 節3/4/6 を改訂し、`psql -h localhost` 前提のシード投入、`flyway/flyway:10.17` コンテナでの baseline→migrate→info、失敗パターン表、Gate 定義を追加。証跡は `artifacts/parity-manual/db-restore/20251109T200035Z/` に集約。 |
| [`docs/server-modernization/phase2/SERVER_MODERNIZED_DEBUG_CHECKLIST.md`](../../../server-modernization/phase2/SERVER_MODERNIZED_DEBUG_CHECKLIST.md) | モダナイズ/運用 | Active | 2025-11-12 | フェーズ4-2 backlog に Legacy JMS 行（`StampSenderMDB` 再起動手順）と「Stamp 公開系 GET 実装 vs UI 差し替え」判断材料を追加。`PHASE2_PROGRESS.md` backlog 行・Appendix A.5 TODO へリンクし、`artifacts/parity-manual/stamp/20251111TstampfixZ3/` を証跡に統一した。 |
| [`docs/server-modernization/phase2/operations/TRACEID_JMS_RUNBOOK.md`](../../../server-modernization/phase2/operations/TRACEID_JMS_RUNBOOK.md) | モダナイズ/運用 | Active | 2025-11-12 | §5.8 に `rest_error_{letter,lab}_audit`（RUN_ID=`20251115TletterAuditZ1` / `20251115TlabAuditZ1`）の結果を追加し、Modern JMS before/after (`messages-added` 0L→1L→2L) をテンプレ化。Legacy 未接続（0L 継続）も Evidence として明文化。 |
| [`docs/server-modernization/phase2/operations/LEGACY_MODERNIZED_CAPTURE_RUNBOOK.md`](../../../server-modernization/phase2/operations/LEGACY_MODERNIZED_CAPTURE_RUNBOOK.md) | モダナイズ/運用 | Active | 2025-11-12 | §3.4「Legacy JMS before/after ログ採取」を新設。helper → `docker compose exec` 二段実行テンプレ、`before/after` 命名、`rg`/`diff`/`less` による確認方法、`PHASE2_PROGRESS.md`・チェックリストとの連携先を追記。 |
| [`artifacts/parity-manual/network/TEMPLATE/README.txt`](../../../../artifacts/parity-manual/network/TEMPLATE/README.txt) | モダナイズ/ネットワーク | Active | 2025-11-12 | ネットワーク復旧テンプレ／RUN_ID コピー手順と pfctl・curl・tcpdump・`docker compose logs` の採取コマンドを記載。Runbook §9 のチェックリスト完了ごとに本備考へ RUN_ID を追記し、DOC_STATUS をエビデンスで更新する。 |
| [`docs/server-modernization/phase2/PHASE2_PROGRESS.md`](../../../server-modernization/phase2/PHASE2_PROGRESS.md) | モダナイズ/運用 | Active | 2025-11-12 | `RUN_ID=20251113Tstamp{Public,Shared,Published}PlanZ1` の 200 応答／Audit/JMS 証跡と `artifacts/parity-manual/stamp/20251113Tstamp<Variation>PlanZ1/` へのリンクを追加し、旧 404 記述を更新。facility ミスマッチ 403（`RUN_ID=20251113TstampPublicPlanZ4`）も backlog からクローズした。 |
| [`docs/server-modernization/phase2/notes/domain-transaction-parity.md`](../../../server-modernization/phase2/notes/domain-transaction-parity.md) | モダナイズ/ドメイン | Active | 2025-11-12 | Appendix A.5 を `RUN_ID=20251113Tstamp{Public,Shared,Published}PlanZ1` の結果へ差し替え、比較表／seed 手順を DONE 化。`ops/db/local-baseline/stamp_public_seed.sql` へ facility=`9001`/user=`9001:doctor1` の seed を追加し、facility ミスマッチ (`RUN_ID=20251113TstampPublicPlanZ4`) の WARN ログ参照先も追記した。 |
| [`docs/web-client/operations/LEGACY_INTEGRATION_CHECKS.md`](../../operations/LEGACY_INTEGRATION_CHECKS.md) | Web クライアント | Active | 2025-11-07 | 旧/新サーバー切替検証の手順書。実施ログを `operations/logs/` に集約する。
| [`docs/server-modernization/phase2/notes/touch-api-parity.md`](../../../server-modernization/phase2/notes/touch-api-parity.md) | モダナイズ/REST/Testing | Active | 2025-11-15 | §12 に RUN_ID=`20251115TapiparityZ1` (全ケース 401) の再測結果・セキュリティヘッダー差分・DB 欠落ログを追記。`tmp/parity-touch/20251115TapiparityZ1/` と `artifacts/parity-manual/smoke/20251115TapiparityZ1/` を Evidence 化し、DB 再シード待ちで compare モードを `text` に退避中。 |
| [`docs/server-modernization/phase2/notes/test-data-inventory.md`](../../../server-modernization/phase2/notes/test-data-inventory.md) | モダナイズ/監査 | Active | 2025-11-10 | §2.4 を新設し、`artifacts/parity-manual/audit/20251110T132800Z/{legacy,modern}_d_audit_event.log` を棚卸。Legacy=0 行 / Modernized=旧データのみというギャップと、WildFly 未展開による再取得待ちを明記。 |
| [`docs/server-modernization/phase2/operations/TRACE_PROPAGATION_CHECK.md`](../../../server-modernization/phase2/operations/TRACE_PROPAGATION_CHECK.md) | モダナイズ/運用 | Active | 2025-11-12 | §7 に `RUN_ID=20251111TclaimfixZ3` の結果（Legacy/Modern200、《JMS messages-added=4L→5L》《d_audit_event` id=80/79/78》）を追記し、`TRACEID_JMS/20251111TclaimfixZ3/claim_send/` と `logs/{jms_dolphinQueue_read-resource,d_audit_event_claim}.txt`、`artifacts/parity-manual/db/20251111TclaimfixZ3/{legacy,modern}/audit_event_{backup.csv,status_log.txt,validation_log.txt}` へのリンクを更新。前 RUN_ID=`20251111TclaimfixZ2`（Legacy404／Modern500）は blockers セクションへ移動。 |
| [`docs/server-modernization/phase2/notes/ops-observability-plan.md`](../../../server-modernization/phase2/notes/ops-observability-plan.md) | モダナイズ/運用 | Active | 2025-11-10 | compose 既定値バイパス手順（`tmp/secrets-repro/missing_factor2|missing_sysad.env` の空白埋め）と WSL での `docker-compose` 不在ブロッカー、Mac/Docker Desktop での再取得計画を追記。 |
| [`docs/server-modernization/operations/API_PARITY_RESPONSE_CHECK.md`](../../../server-modernization/operations/API_PARITY_RESPONSE_CHECK.md) | モダナイズ/REST | Active | 2025-11-09 | 手動比較向けに `compare: "text"` を利用する config（tmp/parity-touch/20251109T060930Z）と実行例を追記。 |
| [`docs/server-modernization/phase2/operations/EXTERNAL_INTERFACE_COMPATIBILITY_RUNBOOK.md`](../../../server-modernization/phase2/operations/EXTERNAL_INTERFACE_COMPATIBILITY_RUNBOOK.md) | モダナイズ/運用 | Active | 2025-11-09 | Gate #44（MmlSenderBeanSmokeTest）を追加し、`tmp/mml-tests/` フィクスチャ確認→`mvn -Dtest=...` 実行→`tmp/mvn-mml.log` 証跡→`artifacts/parity-manual/CLAIM_DIAGNOSIS_FIX/<UTC>/` への保存手順を明文化。 |
| [`docs/server-modernization/phase2/notes/messaging-parity-check.md`](../../../server-modernization/phase2/notes/messaging-parity-check.md) | モダナイズ/連携 | Active | 2025-11-10 | §8.5 を追加し、`diseaseHelper.vm` の再同梱、`docker compose build` → `PARITY_HEADER_FILE`/`PARITY_BODY_FILE` → `./ops/tools/send_parallel_request.sh POST /karte/diagnosis/claim 20251109T231900Z_DIAGNOSIS` で証跡を再取得。`messages-added=1/message-count=0`・DLQ 0 件・`d_diagnosis` に ID=-47 追加の結果を `artifacts/parity-manual/CLAIM_DIAGNOSIS_FIX/20251109T231845Z/` に保存。 |
| [`docs/server-modernization/phase2/notes/domain-transaction-parity.md`](../../../server-modernization/phase2/notes/domain-transaction-parity.md) | モダナイズ/ドメイン | Active | 2025-11-12 | RUN_ID=`20251111TclaimfixZ{2,3}` の Claim/JMS 再取得ログに加え、StampTree GET variations（`20251111TstampfixZ4`〜`Z6`）の 404/404 結果と `logs/d_audit_event_stamp_<variation>_{legacy,modern}.tsv` / `logs/jms_dolphinQueue_read-resource{,_legacy}.txt` を Appendix A.5 に反映。rest_error（letter/lab 200/200, stamp Legacy500/Modern500）と JMS 0L 継続、Basic 認証改善、StampResource 新規ルート設計を残課題として列挙。 |
| [`ops/tests/api-smoke-test/rest_error_scenarios.manual.csv`](../../../ops/tests/api-smoke-test/rest_error_scenarios.manual.csv) / [`README.manual.md`](../../../ops/tests/api-smoke-test/README.manual.md#rest-例外ケース再現テンプレ最新版-run_id20251111t070532z-基準) | モダナイズ/REST 監査 | Active | 2025-11-12 | RUN_ID=`20251115TresterrexZ1` で `rest_error_{bad_request,unauthorized,internal}` を再取得し、`error=invalid_activity_param` 400 / `error=unauthorized` 401（`reason=authentication_failed`）/ `error=karte_lookup_failed` 500 の JSON 期待値と `artifacts/parity-manual/rest-errors/20251115TresterrexZ1/README.md` を追記。ヘッダーテンプレは `tmp/rest-error-headers/trace_http_*_20251115TresterrexZ1.headers` を基準に更新。 |
| [`docs/server-modernization/phase2/notes/storage-mode-checklist.md`](../../../server-modernization/phase2/notes/storage-mode-checklist.md) | モダナイズ/運用 | Active | 2025-11-12 | §2.1 に `attachment-storage.yaml` ローダー設計 (`load_config.sh`) を、§4.1 に既存スタック向け CLI 雛形 (`smoke_existing_stack.sh`) を追加。docker 再構築禁止中でも Secrets 更新と REST 検証だけを進められるよう Runbook を拡張。 |
| [`docs/server-modernization/phase2/notes/reporting-parity.md`](../../../server-modernization/phase2/notes/reporting-parity.md) | モダナイズ/帳票 | Active | 2025-11-12 | §6 を新設し、フォント配置案・`PdfDocumentWriter` 埋め込み設定・`/reporting/karte` CLI テストフロー・既存 `ReportingResource` との差分を整理。Phase7 Runbook（帳票）の再開条件と依存タスクを一覧化した。 |
| [`docs/server-modernization/phase2/notes/rest-touch-diff-report.md`](../../../server-modernization/phase2/notes/rest-touch-diff-report.md) | モダナイズ/REST | Active | 2025-11-11 | CI 取り込み設計（reporting install → snapshot test／RUN_ID 命名／アーティファクト保存フロー）と `tmp/legacy-fixtures/adm10|adm20` のフィクスチャ管理判断材料を追記。方針は「フィクスチャ管理検討中」ステータスで継続レビュー中。 |

| [`security-elytron-migration.md`](../../../server-modernization/phase2/notes/security-elytron-migration.md) | モダナイズ/セキュリティ | Active | 2026-06-16 | LOGFILTER_HEADER_AUTH_ENABLED トグルと Elytron リリース基準を集約。ops/tools/logfilter_toggle.sh の使用方法・次アクションを記載。 |
| [`FACTOR2_RECOVERY_RUNBOOK.md`](../../../server-modernization/phase2/operations/FACTOR2_RECOVERY_RUNBOOK.md) | モダナイズ/運用 | Active(ドラフト) | 2026-06-16 | FACTOR2_AES_KEY_B64 欠落時の起動失敗→復旧ステップを整理。WildFly 起動ログは artifacts/parity-manual/secrets/ に保存し、Docker 利用環境で追補予定。 |

## 今後のタスク
- [ ] 2025-11-15 までに `DTO diff` を CSV 化し Archive へ移動。
- [x] JMS/予約 Runbook 統合後、`WORKER0_MESSAGING_BACKLOG.md` の stub 化を実施。
- [x] Archive フォルダ構成（`docs/archive/2025Q4/`）を整備し、README テンプレを配布。
