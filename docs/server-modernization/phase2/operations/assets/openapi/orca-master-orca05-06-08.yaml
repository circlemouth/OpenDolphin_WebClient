openapi: 3.0.3
info:
  title: ORCA Master APIs (ORCA-05/06/08)
  version: 1.0.0
  description: |
    RUN_ID: 20251219T144408Z (parent: 20251219T144408Z)
    ORCA マスターデータ REST の正式版定義。ORCA DB 定義書 (2024-04-26 正式版)
    と webclient_modernized_bridge の補完設計に基づく。実装前提: DataSource=java:/datasources/OrcaDb。
servers:
  - url: https://modernized.example.orca
    description: modernized server (production candidate)
  - url: http://localhost:8080
    description: local dev (MSW/snapshot 切替時に利用)
tags:
  - name: ORCA-05
    description: 薬剤分類・最低薬価・用法・特定器材・検査分類
  - name: ORCA-06
    description: 保険者・住所マスタ
  - name: ORCA-08
    description: 電子点数表（診療行為区分）
components:
  parameters:
    userNameHeader:
      name: userName
      in: header
      description: ORCA Basic 認証用のユーザー名ヘッダ。
      required: true
      schema:
        type: string
    passwordHeader:
      name: password
      in: header
      description: ORCA Basic 認証用のパスワードヘッダ。
      required: true
      schema:
        type: string
    ifNoneMatchHeader:
      name: If-None-Match
      in: header
      description: ETag によるキャッシュ検証。
      required: false
      schema:
        type: string
    effectiveDate:
      name: effective
      in: query
      description: 取得基準日 (YYYYMMDD)。未指定は当日。
      required: false
      schema:
        type: string
        pattern: "^\\d{8}$"
    keyword:
      name: keyword
      in: query
      description: 部分一致検索キーワード（名称・カナ）
      required: false
      schema:
        type: string
        maxLength: 64
    page:
      name: page
      in: query
      description: 1 始まりのページ番号。既定 1。
      required: false
      schema:
        type: integer
        minimum: 1
        default: 1
    pageSize:
      name: size
      in: query
      description: 1 ページ件数。既定 100、最大 2000。
      required: false
      schema:
        type: integer
        minimum: 1
        maximum: 2000
        default: 100
  schemas:
    MasterMeta:
      type: object
      description: 監査・キャッシュ判定用メタ。全レスポンスに必須。
      properties:
        version:
          type: string
          description: ORCA マスタ版または DB スナップショット日付。
        runId:
          type: string
          description: ドキュメント/取得ログ共通の RUN_ID。
        snapshotVersion:
          type: string
          nullable: true
          description: スナップショットの基準日（MSW/snapshot 取得時）。
        dataSource:
          type: string
          description: 実データ/キャッシュの取得元を示す。
          enum: [snapshot, fallback]
        cacheHit:
          type: boolean
          description: キャッシュヒット時 true。
        missingMaster:
          type: boolean
          description: マスタ未収載時 true。
        fallbackUsed:
          type: boolean
          description: 代替データ（mock/fallback）を使用した場合 true。
        validationError:
          type: boolean
          nullable: true
          description: 入力コード体系の検証で弾かれた場合 true（missingMaster=false と併用）。
        fetchedAt:
          type: string
          format: date-time
          description: 取得日時（ISO 8601）。
      required: [version, runId, dataSource, cacheHit, missingMaster, fallbackUsed, fetchedAt]

    ErrorResponse:
      type: object
      properties:
        code:
          type: string
          description: アプリケーションエラーコード。
        message:
          type: string
          description: ユーザー向けエラーメッセージ。
        runId:
          type: string
        correlationId:
          type: string
          description: 監査・トレース用 ID。
        timestamp:
          type: string
          format: date-time
        validationError:
          type: boolean
          nullable: true
          description: 422 など入力検証エラー時 true。
      required: [code, message, runId, timestamp]

    DrugMasterEntry:
      type: object
      description: ORCA-05 薬剤分類/最低薬価/用法/特定器材/検査分類を統合した最小項目。
      properties:
        code:
          type: string
          description: マスタコード（薬効 3/5 桁・検査分類 4 桁・特定器材 7 桁・SRYCD/点数 9 桁）
          pattern: "^(\\d{3}(\\d{2})?|\\d{4}|\\d{7}|\\d{9})$"
        name:
          type: string
        category:
          type: string
          description: 種別
          enum: [generic, generic-price, youhou, material, kensa-sort]
        unit:
          type: string
          nullable: true
        minPrice:
          type: number
          format: double
          nullable: true
        youhouCode:
          type: string
          nullable: true
          pattern: "^\\d{2,4}$"
        materialCategory:
          type: string
          nullable: true
          pattern: "^[A-Za-z0-9]{2}$"
        kensaSort:
          type: string
          nullable: true
          pattern: "^\\d{2}$"
        validFrom:
          type: string
          pattern: "^\\d{8}$"
        validTo:
          type: string
          pattern: "^\\d{8}$"
        note:
          type: string
          nullable: true
        meta:
          $ref: '#/components/schemas/MasterMeta'
      required: [code, name, category, validFrom, validTo, meta]

    InsurerEntry:
      type: object
      description: ORCA-06 保険者マスタ
      properties:
        payerCode:
          type: string
          description: 保険者番号（8 桁、先頭 2 桁は JIS X0401 都道府県コード）
          pattern: "^\\d{8}$"
        payerName:
          type: string
        payerType:
          type: string
          description: 国保/社保/後期 など
          enum: [national_health, social_insurance, seamen, mutual_aid, late_elderly, other]
        payerRatio:
          type: number
          format: double
        prefCode:
          type: string
        cityCode:
          type: string
        zip:
          type: string
          pattern: "^\\d{7}$"
        addressLine:
          type: string
        phone:
          type: string
          nullable: true
        meta:
          $ref: '#/components/schemas/MasterMeta'
      required: [payerCode, payerName, payerType, payerRatio, prefCode, cityCode, addressLine, meta]

    AddressEntry:
      type: object
      description: ORCA-06 住所マスタ（郵便番号→住所）
      properties:
        zip:
          type: string
          pattern: "^\\d{7}$"
        prefCode:
          type: string
        cityCode:
          type: string
        city:
          type: string
        town:
          type: string
        kana:
          type: string
        roman:
          type: string
          nullable: true
        fullAddress:
          type: string
        meta:
          $ref: '#/components/schemas/MasterMeta'
      required: [zip, prefCode, cityCode, city, town, fullAddress, meta]

    EmptyAddressPayload:
      type: object
      description: 該当がない場合は空オブジェクトを返す。
      additionalProperties: false

    TensuEntry:
      type: object
      description: ORCA-08 電子点数表（診療行為区分）
      properties:
        tensuCode:
          type: string
          description: 診療行為コード（SRYCD、9 桁固定）
          pattern: "^\\d{9}$"
        name:
          type: string
        kubun:
          type: string
          description: 区分コード（診療/薬剤/材料など）
          pattern: "^\\d{2}$"
        tanka:
          type: number
          format: double
        unit:
          type: string
        category:
          type: string
        startDate:
          type: string
          pattern: "^\\d{8}$"
        endDate:
          type: string
          pattern: "^\\d{8}$"
        tensuVersion:
          type: string
          description: 点数表版 (YYYYMM)
          pattern: "^\\d{6}$"
        meta:
          $ref: '#/components/schemas/MasterMeta'
      required: [tensuCode, name, kubun, tanka, unit, category, startDate, endDate, tensuVersion, meta]

  responses:
    NotFound:
      description: 該当データなし。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    ServiceUnavailable:
      description: ORCA DB 不整合またはキャッシュ障害。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    ValidationError:
      description: コード体系の検証エラー（桁数/先頭一致など）。入力の正規化後も不一致の場合に 422 を返す。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            invalidCode:
              value:
                code: "VALIDATION_ERROR"
                message: "コード体系が正しくありません（SRYCD は 9 桁数字で指定してください）"
                runId: "20251219T144408Z"
                correlationId: "2d1f0c3c-5a70-4ad3-8f4c-77c6b1f7b100"
                timestamp: "2025-12-19T14:44:08Z"
                validationError: true
    Unauthorized:
      description: 認証エラー（Basic ヘッダ不備）。
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    NotModified:
      description: ETag 一致時の 304 応答。
      headers:
        ETag:
          $ref: '#/components/headers/ETag'
        Cache-Control:
          $ref: '#/components/headers/Cache-Control'
        Vary:
          $ref: '#/components/headers/Vary'

  headers:
    ETag:
      description: レスポンスの ETag。
      schema:
        type: string
    Cache-Control:
      description: キャッシュ制御ヘッダ。
      schema:
        type: string
    Vary:
      description: キャッシュ差分判定のための Vary。
      schema:
        type: string

paths:
  /orca/master/generic-class:
    get:
      tags: [ORCA-05]
      summary: 薬剤分類ツリー取得
      parameters:
        - $ref: '#/components/parameters/userNameHeader'
        - $ref: '#/components/parameters/passwordHeader'
        - $ref: '#/components/parameters/ifNoneMatchHeader'
        - $ref: '#/components/parameters/keyword'
        - $ref: '#/components/parameters/effectiveDate'
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/pageSize'
      responses:
        '200':
          description: 成功
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
            Cache-Control:
              $ref: '#/components/headers/Cache-Control'
            Vary:
              $ref: '#/components/headers/Vary'
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalCount:
                    type: integer
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/DrugMasterEntry'
              examples:
                sample:
                  value:
                    totalCount: 2
                    items:
                      - code: "211"
                        name: "降圧薬"
                        category: "generic"
                        unit: "tablet"
                        minPrice: 8.5
                        youhouCode: null
                        materialCategory: null
                        kensaSort: null
                        validFrom: "20240401"
                        validTo: "99991231"
                        note: "正式版 2024-04-26"
                        meta:
                          version: "20240426"
                          runId: "20251219T144408Z"
                          snapshotVersion: "2025-11-23"
                          dataSource: "snapshot"
                          cacheHit: false
                          missingMaster: false
                          fallbackUsed: false
                          fetchedAt: "2025-12-19T10:10:00Z"
                      - code: "21101"
                        name: "ACE 阻害薬"
                        category: "generic"
                        unit: "tablet"
                        minPrice: 12.0
                        youhouCode: "Y001"
                        materialCategory: null
                        kensaSort: null
                        validFrom: "20240401"
                        validTo: "99991231"
                        note: null
                        meta:
                          version: "20240426"
                          runId: "20251219T144408Z"
                          snapshotVersion: "2025-11-23"
                          dataSource: "snapshot"
                          cacheHit: false
                          missingMaster: false
                          fallbackUsed: false
                          fetchedAt: "2025-12-19T10:10:00Z"
        '304':
          $ref: '#/components/responses/NotModified'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'

  /orca/master/generic-price:
    get:
      tags: [ORCA-05]
      summary: 薬価・最低薬価取得
      parameters:
        - $ref: '#/components/parameters/userNameHeader'
        - $ref: '#/components/parameters/passwordHeader'
        - $ref: '#/components/parameters/ifNoneMatchHeader'
        - name: srycd
          in: query
          required: true
          schema:
            type: string
            pattern: "^\\d{9}$"
        - $ref: '#/components/parameters/effectiveDate'
      responses:
        '200':
          description: 成功（ヒットなしは price=null）
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
            Cache-Control:
              $ref: '#/components/headers/Cache-Control'
            Vary:
              $ref: '#/components/headers/Vary'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DrugMasterEntry'
              examples:
                hit:
                  value:
                    code: "610008123"
                    name: "アムロジピン錠 5mg"
                    category: "generic-price"
                    unit: "TAB"
                    minPrice: 12.5
                    youhouCode: "Y003"
                    materialCategory: null
                    kensaSort: null
                    validFrom: "20240401"
                    validTo: "99991231"
                    meta:
                      version: "20240426"
                      runId: "20251219T144408Z"
                      snapshotVersion: "2025-11-23"
                      dataSource: "snapshot"
                      cacheHit: false
                      missingMaster: false
                      fallbackUsed: false
                      fetchedAt: "2025-12-19T10:10:10Z"
                noPrice:
                  value:
                    code: "699999999"
                    name: "未収載薬"
                    category: "generic-price"
                    unit: "TAB"
                    minPrice: null
                    youhouCode: null
                    materialCategory: null
                    kensaSort: null
                    validFrom: "20240401"
                    validTo: "99991231"
                    meta:
                      version: "20240426"
                      runId: "20251219T144408Z"
                      snapshotVersion: "2025-11-23"
                      dataSource: "snapshot"
                      cacheHit: false
                      missingMaster: true
                      fallbackUsed: true
                      fetchedAt: "2025-12-19T10:10:10Z"
        '304':
          $ref: '#/components/responses/NotModified'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '422':
          description: SRYCD が 9 桁でない、または体系に存在しない場合のバリデーションエラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalidSrycd:
                  value:
                    code: "SRYCD_VALIDATION_ERROR"
                    message: "SRYCD は数字 9 桁で指定してください"
                    runId: "20251219T144408Z"
                    timestamp: "2025-12-19T17:00:00Z"
                    validationError: true

  /orca/master/youhou:
    get:
      tags: [ORCA-05]
      summary: 用法マスタ取得
      parameters:
        - $ref: '#/components/parameters/userNameHeader'
        - $ref: '#/components/parameters/passwordHeader'
        - $ref: '#/components/parameters/ifNoneMatchHeader'
        - $ref: '#/components/parameters/keyword'
        - $ref: '#/components/parameters/effectiveDate'
      responses:
        '200':
          description: 成功
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
            Cache-Control:
              $ref: '#/components/headers/Cache-Control'
            Vary:
              $ref: '#/components/headers/Vary'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DrugMasterEntry'
              examples:
                sample:
                  value:
                    - code: "10"
                      name: "1日1回 朝食後"
                      category: "youhou"
                      unit: null
                      minPrice: null
                      youhouCode: "10"
                      materialCategory: null
                      kensaSort: null
                      validFrom: "20240401"
                      validTo: "99991231"
                      meta:
                        version: "20240426"
                        runId: "20251219T144408Z"
                        snapshotVersion: "2025-11-23"
                        dataSource: "snapshot"
                        cacheHit: true
                        missingMaster: false
                        fallbackUsed: false
                        fetchedAt: "2025-12-19T10:10:20Z"
        '304':
          $ref: '#/components/responses/NotModified'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'

  /orca/master/material:
    get:
      tags: [ORCA-05]
      summary: 特定器材マスタ取得
      parameters:
        - $ref: '#/components/parameters/userNameHeader'
        - $ref: '#/components/parameters/passwordHeader'
        - $ref: '#/components/parameters/ifNoneMatchHeader'
        - $ref: '#/components/parameters/keyword'
        - $ref: '#/components/parameters/effectiveDate'
      responses:
        '200':
          description: 成功
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
            Cache-Control:
              $ref: '#/components/headers/Cache-Control'
            Vary:
              $ref: '#/components/headers/Vary'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DrugMasterEntry'
              examples:
                sample:
                  value:
                    - code: "5001001"
                      name: "注射器 2.5mL"
                      category: "material"
                      unit: "EA"
                      minPrice: 35.0
                      materialCategory: "A1"
                      validFrom: "20240401"
                      validTo: "20250331"
                      meta:
                        version: "20240426"
                        runId: "20251219T144408Z"
                        snapshotVersion: "2025-11-23"
                        dataSource: "snapshot"
                        cacheHit: false
                        missingMaster: false
                        fallbackUsed: false
                        fetchedAt: "2025-12-19T10:10:30Z"
        '304':
          $ref: '#/components/responses/NotModified'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'

  /orca/master/kensa-sort:
    get:
      tags: [ORCA-05]
      summary: 検査分類マスタ取得
      parameters:
        - $ref: '#/components/parameters/userNameHeader'
        - $ref: '#/components/parameters/passwordHeader'
        - $ref: '#/components/parameters/ifNoneMatchHeader'
        - $ref: '#/components/parameters/keyword'
        - $ref: '#/components/parameters/effectiveDate'
      responses:
        '200':
          description: 成功
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
            Cache-Control:
              $ref: '#/components/headers/Cache-Control'
            Vary:
              $ref: '#/components/headers/Vary'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DrugMasterEntry'
              examples:
                sample:
                  value:
                    - code: "1101"
                      name: "血液検査"
                      category: "kensa-sort"
                      unit: null
                      kensaSort: "11"
                      validFrom: "20240401"
                      validTo: "99991231"
                      meta:
                        version: "20240426"
                        runId: "20251219T144408Z"
                        snapshotVersion: "2025-11-23"
                        dataSource: "snapshot"
                        cacheHit: true
                        missingMaster: false
                        fallbackUsed: false
                        fetchedAt: "2025-12-19T10:10:40Z"
        '304':
          $ref: '#/components/responses/NotModified'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'

  /orca/master/hokenja:
    get:
      tags: [ORCA-06]
      summary: 保険者検索
      parameters:
        - $ref: '#/components/parameters/userNameHeader'
        - $ref: '#/components/parameters/passwordHeader'
        - $ref: '#/components/parameters/ifNoneMatchHeader'
        - name: pref
          in: query
          required: false
          description: 都道府県コード（JIS）
          schema:
            type: string
            pattern: "^(0[1-9]|[1-3][0-9]|4[0-7])$"
        - $ref: '#/components/parameters/keyword'
        - $ref: '#/components/parameters/effectiveDate'
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/pageSize'
      responses:
        '200':
          description: 成功
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
            Cache-Control:
              $ref: '#/components/headers/Cache-Control'
            Vary:
              $ref: '#/components/headers/Vary'
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalCount:
                    type: integer
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/InsurerEntry'
              examples:
                sample:
                  value:
                    totalCount: 1
                    items:
                      - payerCode: "06123456"
                        payerName: "札幌市国民健康保険"
                        payerType: "national_health"
                        payerRatio: 0.7
                        prefCode: "01"
                        cityCode: "01100"
                        zip: "0600001"
                        addressLine: "北海道札幌市中央区北一条西2"
                        phone: "011-123-4567"
                        meta:
                          version: "20240426"
                          runId: "20251219T144408Z"
                          snapshotVersion: "2025-11-23"
                          dataSource: "snapshot"
                          cacheHit: false
                          missingMaster: false
                          fallbackUsed: false
                          fetchedAt: "2025-12-19T10:11:00Z"
        '304':
          $ref: '#/components/responses/NotModified'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
        '422':
          description: 都道府県コードがコード体系と不整合の場合
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalidPref:
                  value:
                    code: "PREF_VALIDATION_ERROR"
                    message: "都道府県コードは 01-47 の 2 桁で指定してください"
                    runId: "20251219T144408Z"
                    timestamp: "2025-12-19T14:44:08Z"
                    validationError: true

  /orca/master/address:
    get:
      tags: [ORCA-06]
      summary: 郵便番号から住所 1 件取得
      parameters:
        - $ref: '#/components/parameters/userNameHeader'
        - $ref: '#/components/parameters/passwordHeader'
        - $ref: '#/components/parameters/ifNoneMatchHeader'
        - name: zip
          in: query
          required: true
          schema:
            type: string
            pattern: "^\\d{7}$"
        - $ref: '#/components/parameters/effectiveDate'
      responses:
        '200':
          description: 成功（該当なしは空オブジェクトを返す）
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
            Cache-Control:
              $ref: '#/components/headers/Cache-Control'
            Vary:
              $ref: '#/components/headers/Vary'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/AddressEntry'
                  - $ref: '#/components/schemas/EmptyAddressPayload'
              examples:
                hit:
                  value:
                    zip: "1000001"
                    prefCode: "13"
                    cityCode: "13101"
                    city: "千代田区"
                    town: "千代田"
                    kana: "チヨダク チヨダ"
                    roman: "Chiyoda-ku Chiyoda"
                    fullAddress: "東京都千代田区千代田"
                    meta:
                      version: "20240426"
                      runId: "20251219T144408Z"
                      snapshotVersion: "2025-11-23"
                      dataSource: "snapshot"
                      cacheHit: false
                      missingMaster: false
                      fallbackUsed: false
                      fetchedAt: "2025-12-19T10:11:10Z"
                empty:
                  value: {}
        '304':
          $ref: '#/components/responses/NotModified'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: 郵便番号未登録
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                notFound:
                  value:
                    code: "MASTER_ADDRESS_NOT_FOUND"
                    message: "指定の郵便番号に該当する住所がありません"
                    runId: "20251219T144408Z"
                    correlationId: "9f2e3a3a-79e3-4f3e-9c2b-d3f1c6a1d001"
                    timestamp: "2025-12-19T10:11:12Z"
        '422':
          description: 郵便番号形式不正（ハイフン除去後 7 桁以外）
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalidZip:
                  value:
                    code: "ZIP_VALIDATION_ERROR"
                    message: "郵便番号は数字 7 桁で指定してください"
                    runId: "20251219T144408Z"
                    timestamp: "2025-12-19T17:00:00Z"
                    validationError: true
        '503':
          $ref: '#/components/responses/ServiceUnavailable'

  /orca/tensu/etensu:
    get:
      tags: [ORCA-08]
      summary: 電子点数表検索
      parameters:
        - $ref: '#/components/parameters/userNameHeader'
        - $ref: '#/components/parameters/passwordHeader'
        - $ref: '#/components/parameters/ifNoneMatchHeader'
        - $ref: '#/components/parameters/keyword'
        - name: category
          in: query
          required: false
          description: "区分コード（例: 11=診療、21=薬剤、31=特定器材）"
          schema:
            type: string
            pattern: "^\\d{1,2}$"
        - name: asOf
          in: query
          required: false
          description: 適用日 (YYYYMMDD)
          schema:
            type: string
            pattern: "^\\d{8}$"
        - name: tensuVersion
          in: query
          required: false
          description: 点数表版。未指定は最新。
          schema:
            type: string
            pattern: "^\\d{6}$"
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/pageSize'
      responses:
        '200':
          description: 成功
          headers:
            ETag:
              $ref: '#/components/headers/ETag'
            Cache-Control:
              $ref: '#/components/headers/Cache-Control'
            Vary:
              $ref: '#/components/headers/Vary'
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalCount:
                    type: integer
                  items:
                    type: array
                    items:
                      $ref: '#/components/schemas/TensuEntry'
              examples:
                sample:
                  value:
                    totalCount: 2
                    items:
                      - tensuCode: "110000001"
                        name: "初診料"
                        kubun: "11"
                        tanka: 288
                        unit: "visit"
                        category: "診察"
                        startDate: "20240401"
                        endDate: "99991231"
                        tensuVersion: "202404"
                        meta:
                          version: "202404"
                          runId: "20251219T144408Z"
                          snapshotVersion: "2025-11-23"
                          dataSource: "snapshot"
                          cacheHit: false
                          missingMaster: false
                          fallbackUsed: false
                          fetchedAt: "2025-12-19T10:11:30Z"
                      - tensuCode: "110000101"
                        name: "再診料"
                        kubun: "11"
                        tanka: 75
                        unit: "visit"
                        category: "診察"
                        startDate: "20240401"
                        endDate: "99991231"
                        tensuVersion: "202404"
                        meta:
                          version: "202404"
                          runId: "20251219T144408Z"
                          snapshotVersion: "2025-11-23"
                          dataSource: "snapshot"
                          cacheHit: true
                          missingMaster: false
                          fallbackUsed: false
                          fetchedAt: "2025-12-19T10:11:30Z"
        '304':
          $ref: '#/components/responses/NotModified'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: 該当なし（空コレクションも可）
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                emptyResult:
                  value:
                    code: "TENSU_NOT_FOUND"
                    message: "指定条件に一致する点数がありません"
                    runId: "20251219T144408Z"
                    timestamp: "2025-12-19T10:11:40Z"
        '422':
          description: コード体系エラー（category 1-2 桁 / asOf 8 桁 / tensuVersion 6 桁などの制約違反）
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalidCategory:
                  value:
                    code: "TENSU_CATEGORY_INVALID"
                    message: "category must be numeric 1-2 digits"
                    runId: "20251219T144408Z"
                    timestamp: "2025-12-19T14:44:08Z"
                    validationError: true
        '503':
          $ref: '#/components/responses/ServiceUnavailable'
