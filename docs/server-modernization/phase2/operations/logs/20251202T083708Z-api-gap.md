# RUN_ID=20251202T083708Z API ギャップ起票

期間: 2025-12-02 09:00 - 2025-12-06 09:00 (JST)

## ギャップ一覧
- `/20/adm/phr/*` 系 (PHR 管理) に対応する modernized REST エンドポイントが存在せず、Administration 画面の PHR 設定が接続不可。`MODERNIZED_REST_API_INVENTORY` にも未掲載。
- `/orca12/patientmodv2` → `POST /orca/patient/mutation` は spec-based スタブのまま。患者編集/登録時の Api_Result・監査フィールド未取得。
- `/api21/medicalmodv2` → `POST /orca/medical/records` は spec-based。ORCA POST が閉鎖されており、実レスポンス shape／エラーコードの確認ができていない。
- `/orca11/acceptmodv2`・`/orca14/appointmodv2` → `POST /orca/visits/mutation` / `POST /orca/appointments/mutation` は ORCA 側 Allow: GET/OPTIONS (HTTP 405) のため受付/予約登録を Modernized 経由で通せていない。Api_Result 監査ログも未取得。

## 想定影響
- Reception/Schedule: 受付・予約の POST/PUT が Trial/ORMaster どちらも失敗するため、MSW かローカル DB スタブに依存。`dataSource`/`fallbackUsed` の監査フィールドも欠落。
- Charts/Patients: 患者編集・カルテ POST が ORCA 側と整合確認できず、Api_Result エラーコードの扱いが未定義。万一 ORCA 実線を開けた場合の Nullability 差異リスクが残存。
- Administration: PHR 系の UI 要求を満たす REST ルートが欠落しており、現状は実装不可。

## 依頼/Next action (modernized server チーム)
1) PHR ルートの REST 化有無を確認し、提供可否と予定を共有してください（該当する OpenAPI があればパスを提示ください）。  
2) `/orca12/patientmodv2` `/api21/medicalmodv2` の ORCA 実測機会を調整し、Api_Result とエラーフィールドの差分を取得したいです。実測不可の場合は stub 応答に監査フィールド（dataSource/cacheHit/fallbackUsed）と想定 Api_Result を埋め込みください。  
3) `/orca11/acceptmodv2` `/orca14/appointmodv2` の 405 解消計画（route enable）と再試行日時を共有してください。解消後に `docs/server-modernization/phase2/operations/logs/<RUN_ID>-api-gap.md` へ追記します。

## 参照
- `src/webclient_screens_plan/02_画面別 API マッピングとバージョン整合.md`
- `docs/server-modernization/MODERNIZED_REST_API_INVENTORY.md`
- `artifacts/api-stability/20251124T000000Z/master-sync/20251124/diffs/server-vs-msw-orca{05,06,08}.json`
- `artifacts/ci-dryrun/20251124T153000Z/openapi.diff`
