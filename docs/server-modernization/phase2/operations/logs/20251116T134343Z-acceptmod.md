# RUN_ID=20251116T134343Z `/orca11/acceptmodv2` Trial ログ

- 参照チェーン: `AGENTS.md` → `docs/web-client/README.md` → `docs/server-modernization/phase2/INDEX.md` → `PHASE2_ORCA_PHR_GAP_MANAGER_CHECKLIST.md`。
- 対象: `POST /orca/visits/mutation` の REST 実装とフロントエンド予約 UI の受付同期設計。
- 実装概要: `server-modernized/src/main/java/open/dolphin/orca/rest/OrcaVisitResource.java` 追加、`open/dolphin/orca/service/OrcaWrapperService.java` に acceptmodv2 DTO/Converter を実装、`web-client/src/features/reception/api/appointment-api.ts` から `VisitMutationRequest` 連携を準備。

## 1. Trial 実行計画
| 手順 | コマンド | 備考 |
| --- | --- | --- |
| 1 | `curl -vv -u trial:weborcatrial --data-binary @payloads/acceptmod_trial.xml https://weborca-trial.orca.med.or.jp/orca11/acceptmodv2?class=01` | HTTP 405 想定。`artifacts/orca-connectivity/20251116T134343Z/acceptmodv2/trial/` にログを保存。 |
| 2 | `curl -vv -u ormaster:ormaster https://ormaster.orca.med.or.jp/orca11/acceptmodv2?class=01` | ORMaster 回線での代替。DNS/TLS が開放されたら再測。 |

CLI sandbox のネットワーク制限によりコマンドは未実行。許可端末で再現する場合は同一 RUN_ID を使用し、本ログを更新すること。

## 2. 成果物
- ソース: `server-modernized/src/main/java/open/dolphin/rest/dto/orca/VisitMutationRequest.java` 等を追加。`OrcaXmlMapper` で acceptmodv2 XML → DTO を解析。
- Web クライアント: 予約 API から返る `externalId` を `saveAppointments` 経由で `POST /orca/appointments/mutation` に連携。受付ラッパーは UI 側の後続実装待ち。
- 証跡スタブ: `artifacts/orca-connectivity/20251116T134343Z/acceptmodv2/README.md`。

## 3. 次アクション
1. Trial API で HTTP 405 → 200 の切替を確認し、`docs/server-modernization/phase2/operations/ORCA_API_STATUS.md` No.4 を更新。
2. 受付ラッパーと PVT 同期 (ChartEvent SSE) を実装して UI 即時反映を検証。
3. `docs/server-modernization/phase2/operations/logs/ORCA_HTTP_404405_HANDBOOK.md` に RUN_ID を追記し、Blocker=`TrialLocalOnly` セクションを更新。
