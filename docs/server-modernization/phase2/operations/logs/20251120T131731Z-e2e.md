# RUN_ID=20251120T131731Z 統合 E2E 接続確認ログ（Web クライアント連携）

- 期間: 2025-12-12 09:00 〜 2025-12-17 09:00 (JST)
- 状態: **子 RUN（20251122T071146Z）で部分実施 → Blocked**。Stage 接続先不明／ブラウザ未用意のため UI 実測は未完。mac-dev ORCA patientlst2v2=404、TLS 443/8443 失敗を確認。子 RUN のリンク整合結果で上書き済（未取得箇所は明示）。 
- 参照チェーン: `AGENTS.md` → `docs/web-client/README.md` → `docs/server-modernization/phase2/INDEX.md` → `docs/managerdocs/PHASE2_MANAGER_ASSIGNMENT_OVERVIEW.md` → `docs/managerdocs/PHASE2_WEB_CLIENT_EXPERIENCE_MANAGER_CHECKLIST.md` / `docs/managerdocs/PHASE2_SERVER_FOUNDATION_MANAGER_CHECKLIST.md`
- RUN_ID: `20251120T131731Z`（派生 RUN_ID を作成する場合は親 RUN_ID を併記）
- 証跡ディレクトリ: `artifacts/e2e-connect/20251120T131731Z/`
- 子 RUN: `20251122T071146Z` を発行済み。CLI 端末では UI/ブラウザ操作ができず E2E は未実施。TLS/HTTP 疎通（100.102.17.40 への `curl -I`、`openssl s_client` 失敗ログ）とローカルログ抜粋のみ `artifacts/e2e-connect/20251122T071146Z/` に保存。GUI 端末での再実行が必要。
- 雛形整備済み・Stage 接続先待ち（`artifacts/e2e-connect/20251122T071146Z/README.md` を参照）。
- 2025-11-22: Stage 接続先情報リクエストテンプレを 09 章末尾へ追加済み。Ops/SRE への送付と回答待ち。

## 実施メモ（追記用）
- 環境 / 接続先:
  - Web クライアント: MSW 無効化／`VITE_DEV_PROXY_TARGET` でモダナイズ版サーバーへ接続する設定を明記。
  - サーバー: 開発用 ORCA 接続設定（`mac-dev-login.local.md` 参照）。
- 証跡収集方針: HAR or HTTP dump、スクリーンショット、サーバー log 抜粋をシナリオ単位で保存し、本ログから相対パスで参照する。
- 機微情報のマスキング: 患者 ID / トークン / Cookie 等は記載前に伏せ字化する。

## シナリオ記録テンプレート
| シナリオ | 前提・期待結果 | 実績 (Pass/Fail/Blocked) | 証跡パス | 備考 |
| --- | --- | --- | --- | --- |
| 認証/セッション延長 | 例: ログイン成功、Token refresh が 401→再認証 | **Blocked** | `artifacts/e2e-connect/20251122T071146Z/httpdump/auth/patientlst2v2_20251122T132823Z.{curl.log,xml}` | mac-dev ORCA へ Basic 認証は通過するが 404 応答。Stage Web クライアント接続先が不明。 |
| 受付/予約 | 例: 患者検索→受付登録→予約作成/更新 | **Blocked** | `artifacts/e2e-connect/20251122T071146Z/httpdump/reception/` | Stage/ORCA seed・エンドポイント未確定（ディレクトリのみ、証跡未取得）。 |
| カルテ閲覧/保存 | 例: DocInfo 取得、ChartEvent 保存（期待 HTTP 200/409）、エラー表示 | **Blocked** | `artifacts/e2e-connect/20251122T071146Z/httpdump/charts/version_localhost_20251122T132903Z.curl.log` | localhost:8080 は接続拒否。Stage API URL 取得待ち。 |
| ORCA ラッパー | 例: acceptmod/appointmod 呼び出し、Trial 405/seed 不足は Blocker として記録 | **Blocked** | `artifacts/e2e-connect/20251122T071146Z/httpdump/orca-wrapper/` | 基礎 API 404 のため代表 API 実測未実施（ディレクトリのみ、証跡未取得）。 |
| エラーハンドリング | 例: ネットワーク遮断、トークン失効、4xx/5xx UI 表示 | **部分済** | `artifacts/observability/20251122T071146Z/traceid-error-boundary.png`<br>`artifacts/e2e-connect/20251122T071146Z/httpdump/tls/100.102.17.40_{443,8443}_20251122T1329*.txt` | TraceId UI 表示は既存証跡で確認。TLS ハンドシェイク失敗を記録。token 失効/遮断は未実施。 |

## リンク整合メモ（子 RUN=20251122T071146Z）
- `httpdump/auth/patientlst2v2_20251122T132823Z.{curl.log,xml}` / `httpdump/charts/version_localhost_20251122T132903Z.curl.log` / `httpdump/tls/*.txt` / `server-logs/server_latest_logs_excerpt.txt` は存在を確認。
- `httpdump/reception/` `httpdump/orca-wrapper/` `har/` `screenshots/` `trace/` はディレクトリのみで、証跡は未取得である旨を子ログに明記。
- TraceId UI スクショ: `artifacts/observability/20251122T071146Z/traceid-error-boundary.png` を参照。

## 仕分け・エスカレーション（追記用）
- サーバー側で対応可能:
  - [ ] 例: seed 追加、互換レイヤー設定、レスポンス補完
- クライアント連携チームへエスカレーション:
  - [ ] 例: UI メッセージ改善、リトライ/タイムアウト調整、ルーティング差分

## 次アクション
- 実測完了後、`DOC_STATUS.md` 備考欄へ RUN_ID と本ログ/証跡パスを追記する。
- Blocker が発生した場合は `ORCA_API_STATUS.md` や関連チェックリストへ反映し、担当と期限を明示する。
