# 2025-11-16 ORCA Sprint2 ドキュメント同期ログ

- RUN_ID: `20251116T164200Z`
- 担当: Worker-A（Web クライアント / モダナイズ連携）
- 参照チェーン: `AGENTS.md` → `docs/web-client/README.md` → `docs/server-modernization/phase2/INDEX.md` → `docs/managerdocs/PHASE2_ORCA_SPRINT2_MANAGER_CHECKLIST.md` → `docs/server-modernization/phase2/domains/ORCA_REST_IMPLEMENTATION_NOTES.md` §6 → `docs/server-modernization/MODERNIZED_REST_API_INVENTORY.md`
- 成果物: 本ログ＋関連ドキュメント diff（ORCA REST 実装メモ / MODERNIZED REST インベントリ / API パリティマトリクス / DOC_STATUS）、`mvn -pl server-modernized -DskipITs test` 実行結果。

## 1. ドキュメント更新サマリ
1. `docs/server-modernization/phase2/domains/ORCA_REST_IMPLEMENTATION_NOTES.md` §6 へ以下 5 API の DTO/契約差分と Trial Blocker を追記。
   - Matrix No.2 `/orca14/appointmodv2` → `POST /orca/appointments/mutation`
   - Matrix No.4 `/orca11/acceptmodv2` → `POST /orca/visits/mutation`
   - Matrix No.11 `/api01rv2/system01lstv2` → `POST /orca/system/management`
   - Matrix No.32 `/orca101/manageusersv2` → `POST /orca/system/users`
   - Matrix No.42 `/orca42/receiptprintv3` → `POST /orca/report/print`
   各節に firecrawl 仕様リンク（`report_print/systemkanri/userkanri/acceptmod/appointmod`）と `Trial通信不可だが実装完了（RUN_ID=20251116T164200Z, 仕様ベース）` 注記を付与。
2. `docs/server-modernization/MODERNIZED_REST_API_INVENTORY.md` §7 の表を Matrix No.2/4/11/32/42 へ拡張。モダナイズ REST パス・状況を追記し、備考欄へ同タグを追加。
3. `docs/server-modernization/phase2/domains/API_PARITY_MATRIX.md`「ORCA API ラッパー計画」を同じ番号帯で更新。設計アンカー（ORCA_REST_IMPLEMENTATION_NOTES の該当見出し）と Trial 非通信メモを明記。
4. `docs/web-client/planning/phase2/DOC_STATUS.md` 行 35 を更新し、最終レビュー日を 2025-11-16／RUN_ID／証跡パス（本ログ）を記録。

## 2. Trial 通信制約メモ
- `artifacts/orca-connectivity/20251115TrialConnectivityCodexZ1/blocked/README.md` と `docs/server-modernization/phase2/operations/assets/orca-trialsite/raw/trialsite.md#お使いいただけない機能等` を再確認し、以下 API は Trial サーバーで POST 不可（HTTP 405 or GUI 封鎖）のため、本 RUN では firecrawl 仕様ベースでの整備に留めた。
  - `/orca14/appointmodv2`, `/orca11/acceptmodv2`: Allow ヘッダーに `OPTIONS, GET` のみ。Doctor/patient seed 再投入待ち。
  - `/api01rv2/system01lstv2`, `/orca101/manageusersv2`: 管理メニュー非公開のため API 実行権限なし。
  - `/orca42/receiptprintv3`: trialsite §4 で帳票印刷禁止。`push-exchanger`/`/blobapi` も利用不可。
- 上記の証跡と再開条件を `docs/server-modernization/phase2/operations/logs/20251116T164200Z-orca-sprint2.md#2-trial-通信制約メモ` から引用できるよう `API_PARITY_MATRIX.md`／`MODERNIZED_REST_API_INVENTORY.md` の該当行にタグを追加。

## 3. ビルド / テスト
```
mvn -pl server-modernized -DskipITs test
```
- 成果: `server-modernized` モジュールのユニットテスト 5 クラス（`RequestMetricsFilterTest`, `KanaToAsciiTest`, `MessagingDefensiveCopyTest`, `TouchDtosDefensiveCopyTest`, `DolphinResourceDocumentTest`）がすべて成功（Failures=0, Errors=0）。
- 警告: `sun.misc.Unsafe` / ByteBuddy / SLF4J provider 警告は既知のライブラリアップデート待ち（従来 RUN と同じ内容）。JBoss LogManager 初期化順序も `WildFly33` ガイドどおりで問題なし。

## 4. 次アクション / ToDo
- Trial 環境で POST が解禁された時点で `ORCA_CONNECTIVITY_VALIDATION.md` §4.3-§4.4 のテンプレへ CRUD 手順を復帰させる。
- `ReportPrintJobService` / `push-exchanger` 連携はローカル ORMaster 環境または顧客環境での再実行が必須。`artifacts/orca-connectivity/20251120TorcaHttpLogZprep` を初期ディレクトリとして利用予定。
- `PHASE2_ORCA_SPRINT2_MANAGER_CHECKLIST.md` タスクC（DOC_STATUS 整合）を完了扱いにし、マネージャーからの承認待ち。
