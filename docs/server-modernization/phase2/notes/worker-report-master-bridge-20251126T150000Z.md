# 【ワーカー報告】RUN_ID=20251126T150000Z

- Stage/Preview/Playwright/curl 検証:
  1. Stage Preview は `VITE_DISABLE_MSW=1 VITE_DEV_PROXY_TARGET=http://localhost:8000/openDolphin/resources VITE_API_BASE_URL=http://localhost:8000/openDolphin/resources VITE_DEV_USE_HTTPS=1 npm run preview -- --host 0.0.0.0 --port 4173 --strictPort` で起動し、`d_facility`/`d_users` に admin 認証情報を seed して `userName=1.3.6.1.4.1.9414.70.1:admin` + `password=21232f297a57a5a743894a0e4a801fc3` を付与。`artifacts/e2e/20251126T150000Z/stage-preview.log` には Reception/Claim を含む Live baseURL coverage で `warning banner tone=server` および `dataSourceTransition=server` を返す実測が記録された。このセッションは TypeScript/Vite build 修正後（2025-11-27 JST セッション）に再実行され、Stage Preview のログも上書きされたため、DOC_STATUS/manager checklist/worker report の RUN_ID セクションに同じパスと観測結果を反映した。
  2. Playwright（`PLAYWRIGHT_BASE_URL=https://localhost:4173 npx playwright test tests/e2e/orca-master.spec.ts`）は Live profile `dataSource=server/runId=20251126T150000Z/missingMaster=false/fallbackUsed=false` を返し 1 pass + 8 skip で完了。`artifacts/e2e/20251126T150000Z/playwright-orca-master.log` には `Live profile=server`・`warning banner tone=server`・`dataSourceTransition=server` を含むイベントが記録され、`artifacts/e2e/20251126T150000Z/master-bridge-stub-check.log` には `curl` ルーチンで再現した warning tone と transition が書き込まれている。
  3. `curl`（admin header）で `/resources/api/orca/master/generic-class`〜`/etensu` 8 本を取得し、すべて `dataSourceTransition=server->fallback`/`missingMaster=true`/`fallbackUsed=true`/`runId=20251126T150000Z`/`version=20251126`/`cacheHit=false`/`warning banner tone=server` の empty list を確認し、`artifacts/e2e/20251126T150000Z/master-bridge-stub-check.log` および `docs/server-modernization/phase2/operations/logs/20251126T150000Z-master-bridge-stub-update.md` に記録した。`master-bridge-stub-check.log` には各 `curl` に対する HTTP_STATUS:200 も追記され、最新の `warning banner tone=server`/`dataSourceTransition` 証跡として DOC_STATUS/manager checklist/worker report に同期した。

- Live coverage / warning tone 監視:
  - Stage Preview/Playwright のログを起点に Reception/Claim coverage から `warning banner tone=server`・`dataSourceTransition=server` を継続観測し、`dataSource=server/runId=20251126T150000Z` の Live coverage が維持されていることを確認。これらのログと `docs/server-modernization/phase2/operations/logs/20251126T150000Z-master-bridge-stub-update.md` には該当するイベントを追記し、再検証ごとに `artifacts/e2e/20251126T150000Z/*` を上書いて比較している。
  - 2025-11-27 JST の Stage Preview/Playwright/curl 再実行で `artifacts/e2e/20251126T150000Z/{stage-preview.log,playwright-orca-master.log,master-bridge-stub-check.log}` を上書きし、DOC_STATUS/manager checklist/worker report RUN_ID セクションにはこの最新ログパスと `warning banner tone=server`/`dataSourceTransition=server` の観測メモを同期している。

- Bridge sync & artifacts:
  1. raw B 更新後に `node scripts/bridge-sync.mjs --run-id 20251126T150000Z --date 20251124 --source server` を実行し、`schema missing: artifacts/api-stability/20251124T151500Z/ab-compare/20251124T153000Z/raw/B/orca-master-generic-class.json` を確認。`artifacts/api-stability/20251124T000000Z/master-sync/20251124/hashes/server/{orca05.hash,orca06.hash,orca08.hash}` と `artifacts/api-stability/20251124T000000Z/master-sync/20251124/diffs/server-vs-msw-orca*.json` を上書きし、`auditSummary` に `serverDataSource=snapshot`/`serverMissingMaster=false`/`serverFallbackUsed=false` を記録した。
    - 上書きした `hashes`/`diffs` で得られた `dataSourceTransition=server`/`missingMaster` の状態は DOC_STATUS/manager checklist/この worker report に順次反映し、`artifacts/e2e/20251126T150000Z/` および `docs/server-modernization/phase2/operations/logs/20251126T150000Z-master-bridge-stub-update.md` も同様にリンクを追加している。
    - Stage Preview/Playwright/curl の再実行後も同じ `node scripts/bridge-sync.mjs --run-id 20251126T150000Z --date 20251124 --source server` を回して `hashes`/`diffs` を上書きし、`dataSourceTransition=server`/`missingMaster` が server ルートへ寄った観測値を記録して DOC_STATUS/manager checklist/worker report に波及している。

- Build blockers:
- `npm run build`（2025-11-26）は TypeScript 修正を取り込んだコードで正常終了し、`docs/server-modernization/phase2/notes/issue-master-bridge-build.md` に修正内容と新 dist の証跡を記録。Stage/Playwright/curl の再検証（2025-11-27 JST セッション）により `artifacts/e2e/20251126T150000Z/{stage-preview.log,playwright-orca-master.log,master-bridge-stub-check.log}` を上書きし、`warning banner tone=server`/`dataSourceTransition=server` と `curl` のサーバルート応答を再確認できた。
  - `mvn -pl server-modernized -DskipTests compile`（2025-11-26）は `UserModel#getRegisteredDateAsString()` の再導入後に成功。`docs/server-modernization/phase2/notes/issue-master-bridge-build.md` には `opendolphin-common` 再インストールと getter 追加を記載し、Modernized の jar 供給は確保された。

- 証跡ファイルパス:
  - `docs/server-modernization/phase2/operations/logs/20251126T150000Z-master-bridge-stub-update.md`
  - `artifacts/e2e/20251126T150000Z/stage-preview.log`
  - `artifacts/e2e/20251126T150000Z/playwright-orca-master.log`
  - `artifacts/e2e/20251126T150000Z/master-bridge-stub-check.log`
  - `artifacts/api-stability/20251124T000000Z/master-sync/20251124/hashes/server/{orca05.hash,orca06.hash,orca08.hash}`
  - `artifacts/api-stability/20251124T000000Z/master-sync/20251124/diffs/server-vs-msw-orca*.json`
  - `artifacts/api-stability/20251124T151500Z/ab-compare/20251124T153000Z/raw/B/orca-master-generic-class.json`（schema missing）
  - `docs/server-modernization/phase2/notes/issue-master-bridge-build.md`

- 未完タスク／次アクション:
  1. raw B → bridge-sync → hashes/diffs → DOC_STATUS/manager checklist/worker report のループを継続し、`dataSourceTransition`/`missingMaster` が server ルートへ寄るたびに `artifacts/api-stability/20251124T000000Z/master-sync/20251124/` を上書きして証跡化。
  2. Reception/Claim を含む Live baseURL coverage と `warning banner tone=server` を Stage/Live Playwright で継続的に再検証し、`artifacts/e2e/20251126T150000Z/stage-preview.log` / `artifacts/e2e/20251126T150000Z/playwright-orca-master.log` を DOC_STATUS/manager checklist/worker report と同期する。
  3. ドキュメント同期: `docs/web-client/planning/phase2/DOC_STATUS.md:65`・`docs/managerdocs/PHASE2_WEB_CLIENT_EXPERIENCE_MANAGER_CHECKLIST.md:55-56`・本報告の RUN_ID セクションへ RUN_ID/証跡パス・`warning banner tone=server`/`dataSourceTransition=server` イベント・次アクションの追記を完了。今後はこの RUN_ID で上書いたログを参照しながらループを継続。
  4. 再検証テンプレ: raw B 更新（ORCA 特材など）を感知したら `node scripts/bridge-sync.mjs --run-id 20251126T150000Z --date 20251124 --source server` で `artifacts/api-stability/20251124T000000Z/master-sync/20251124/hashes/server/{orca05.hash,orca06.hash,orca08.hash}` と `diffs/server-vs-msw-orca*.json` を更新し `schema missing: artifacts/api-stability/20251124T151500Z/ab-compare/20251124T153000Z/raw/B/orca-master-generic-class.json` を確認、続いて Stage Preview/Playwright/curl を同 RUN_ID で回して `dataSourceTransition=server` の移行と `warning banner tone=server` を追跡。Stage Preview: `VITE_DISABLE_MSW=1 VITE_DEV_PROXY_TARGET=http://localhost:8000/openDolphin/resources VITE_API_BASE_URL=http://localhost:8000/openDolphin/resources VITE_DEV_USE_HTTPS=1 npm run preview -- --host 0.0.0.0 --port 4173 --strictPort` で `artifacts/e2e/20251126T150000Z/stage-preview.log` を更新し、Playwright: `RUN_ID=20251126T150000Z VITE_DISABLE_MSW=1 VITE_DEV_PROXY_TARGET=http://localhost:8000/openDolphin/resources VITE_API_BASE_URL=http://localhost:8000/openDolphin/resources PLAYWRIGHT_BASE_URL=https://localhost:4173 npx playwright test tests/e2e/orca-master.spec.ts` で `artifacts/e2e/20251126T150000Z/playwright-orca-master.log` に Live profile を残し、curl: admin header + eight endpoints `/resources/api/orca/master/{generic-class,generic-price,youhou,material,kensa-sort,hokenja,address,etensu}` で `dataSourceTransition=server->fallback`/`missingMaster=true`/`fallbackUsed=true`/`runId=20251126T150000Z`/`version=20251126`/`cacheHit=false`/`warning banner tone=server` を `artifacts/e2e/20251126T150000Z/master-bridge-stub-check.log` に記録。各サイクルの RUN_ID・`artifacts/api-stability/.../hashes`・`diffs`・`artifacts/e2e/20251126T150000Z/{stage-preview.log,playwright-orca-master.log,master-bridge-stub-check.log}` を DOC_STATUS/manager checklist/issue note へ波及させ、raw B 更新トリガー割当時に本手順順を再走する。現時点では raw B 更新を追いかけずドキュメント整備を優先し、次の更新感知後に再走を再開することを明記。
