# 27 P1改修_処方詳細入力補助

RUN_ID: 20251229T213910Z

## 目的
- 処方オーダー（RP）の詳細入力差分（院内/院外・頓用/臨時・日数/回数）と RP 名補正の差分を解消する。

## 対象画面/機能
- Charts 右パネル `OrderBundleEditPanel`（entity=medOrder）

## 旧来版との差分（要約）
- 院内/院外: ラジオ選択で Project.RP_OUT に保存（Web では UI なし）。
- 頓用/臨時: チェック（相互排他）で区分コードに反映（Web では UI なし）。
- 日数/回数: 用法行のみ入力可能（Web では回数のみ手入力）。
- RP 名: 空欄時にデフォルト補正（Web は必須入力）。

## Web 目標挙動（実装範囲）
- 院内/院外、頓用/臨時の UI を追加し、排他制御を行う。
- 日数/回数のラベル/入力を処方 UI に拡張する（bundleNumber を使用）。
- RP 名が空欄の場合は Web 側で補正ルールを適用して保存する。
- 保存時に処方区分（classCode/className/classCodeSystem）を送信・復元する。

## 依存/前提（server-modernized）
- `/orca/order/bundles` が classCode/className/classCodeSystem の保存・取得に対応していること。
  - 不足が判明した場合は server-modernized タスクを起票する。

## 実装メモ
- 区分コード: regular=211/212, 頓用=221/222, 臨時=291/292（院内=末尾1 / 院外=末尾2）。
- classCodeSystem: `Claim007`。
- RP 名補正: 空欄時は 1件目の薬剤名 → 処方区分ラベルの順に補正。

## テスト観点
- 院内/院外の切替と頓用/臨時の排他が UI で反映される。
- 日数/回数入力を保存 → 再編集で値が一致する。
- RP 名が空欄でも保存でき、補正後の名称で再編集できる。
