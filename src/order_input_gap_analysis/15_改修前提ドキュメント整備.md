# 15 改修前提ドキュメント整備

RUN_ID: 20251229T012712Z

## 目的
- 差分判定後の Web 改修タスク（P0/P1/P2）に必要な前提情報を一箇所に集約し、実装前の認識ズレを防ぐ。

## 参照（正本）
- docs/DEVELOPMENT_STATUS.md
- src/order_input_gap_analysis/09_差分マトリクス統合.md
- src/order_input_gap_analysis/12_差分判定_修正区分.md

## 改修対象の判断基準（要約）
- UI/入力補助/操作フロー起因の差分は Web クライアント改修対象。
- 既存の server-modernized API がある場合はサーバー改修不要。
- readOnly/missingMaster/fallbackUsed など Web の安全ガードは優位性として維持。

## Web 改修の前提条件
- Web の保存フローは `/orca/order/bundles` を継続利用する。
- マスタ検索・部位検索・用法検索などは server-modernized のマスタ API を利用する前提で UI を設計する。
- 監査ログの `runId`/`screen`/`operationPhase` の付与は既存規約に合わせる。
- 既存の編集ブロック条件（readOnly/missingMaster/fallbackUsed）は維持したまま UI を追加する。

## 既存 API 参照メモ（server-modernized）
- `/orca/master/*` 系（用法/材料/点数/検査ソートなど）を前提に入力補助を設計する。
- `/orca/order/bundles` の create/update/delete を継続利用する。
- スタンプ生成は `/stamp/{param}` が存在するが、Web UI 実装方針の決定が必要。

## 非対象（今回の改修に含めない）
- 旧来版のカルテ展開処理を完全再現するサーバー拡張。
- ORCA 実環境での接続検証（別手順で実施）。
- Legacy `client/` および `server/` への変更。

## 改修タスク化の入力テンプレ（P0/P1/P2共通）
- 対象画面/機能:
- 旧来版の挙動（差分要約）:
- Web 目標挙動（実装範囲）:
- 依存 API/データ:
- 監査/ログ要件:
- ブロッカー:
- テスト観点:
