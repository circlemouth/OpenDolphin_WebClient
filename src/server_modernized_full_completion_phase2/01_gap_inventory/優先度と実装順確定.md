# 優先度と実装順確定（RUN_ID=20251219T065150Z）

対象期間: 2025-12-20 21:00 - 2025-12-21 21:00

## 目的
- server-modernized 実装の優先順位を「ORCA Master → 監査・JMS → 外部 API → Jakarta 設定」の順で確定する。
- 依存関係とテスト順序を明文化し、ガントへ反映する。

## 参照ドキュメント
- `src/server_modernized_full_completion_phase2/01_gap_inventory/実装状況ドキュメント棚卸し.md`
- `docs/server-modernization/phase2/foundation/JAKARTA_EE10_GAP_LIST.md`
- `docs/server-modernization/phase2/notes/MODERNIZED_SERVER_GAP_TRACKER_20251116T210500Z.md`
- `docs/server-modernization/phase2/operations/ORCA_API_STATUS.md`
- ガント: `.kamui/apps/server-modernized/server-modernized-implementation-20251219.yaml`

## 実装優先度と順序（確定）
1. **ORCA Master**（`04_orca_master_api` + ORCA 接続再測定）
2. **監査・JMS**（`06_messaging_audit_trace`）
3. **外部 API**（`07_external_api`）
4. **Jakarta 設定**（`02_jakarta_foundation`）

> 補足: カルテ/添付（`03_kartes_and_attachments`）と Ops/Security は Jakarta 設定完了後に着手し、上記 4 系列の順序を崩さない。

## 依存関係（要点）
- ORCA Master 系列は優先度確定の完了後に着手し、Master API 実装 → OpenAPI/契約更新 → ORCA 接続再測定の順で完了させる。
- 監査・JMS 系列は ORCA 接続再測定の完了後に着手する（Trace/Audit の証跡取得を先行）。
- 外部 API 系列は監査・JMS の監査連携が完了した後に着手する（200 証跡の収集を前提にする）。
- Jakarta 設定は外部 API 系列の証跡取得完了後に着手する（web.xml/beans.xml 更新、JMS/EE Concurrency/HTTPS/Elytron を順に確定）。

## テスト順序（確定）
1. **ORCA Master**: 契約テスト（OpenAPI/DTO）→ ORCA_API_STATUS 再測定 → キャッシュ/ETag/ベンチ検証
2. **監査・JMS**: 4xx/5xx 監査連携 → SessionOperation 拡張 → JMS ACK 検証 → Trace Runbook 更新
3. **外部 API**: PHR CRUD 実測 → 画像ストリーム → 予約/受付ラッパー → MML/紹介状
4. **Jakarta 設定**: Jakarta スキーマ更新 → 依存整備 → WildFly/JMS/EE Concurrency → HTTPS/Forwarded → Elytron/セキュリティ

## ガント反映
- `.kamui/apps/server-modernized/server-modernized-implementation-20251219.yaml` の依存関係とスケジュールを上記順序に合わせて更新した。
- 以降のガント更新は同ファイルを単一ソースとし、DOC_STATUS/README の RUN_ID を同期する。

## DOC_STATUS / README 反映
- `docs/web-client/planning/phase2/DOC_STATUS.md` に RUN_ID と成果物を追記する。
- `docs/web-client/README.md` の最新更新サマリと Active 一覧へ反映する。
