# スタンプ削除監査イベント整合検証・追加（predeploy readiness）

- RUN_ID: `20251220T235800Z`
- 期間: 2025-12-25 09:00 - 2025-12-26 09:00 (JST)
- 優先度: high / 緊急度: medium
- YAML ID: `src/predeploy_readiness/01_api_implementation/スタンプ削除監査イベント整合検証・追加.md`
- 参照タスク: `.kamui/apps/server-modernized-predeploy-ready-plan-20251220.yaml`（スタンプ削除監査イベント整合検証・追加）

## 目的
- スタンプ削除監査イベントの必須フィールド（requestId/traceId/errorMessage）整合を確認し、不足があれば実装・要件へ反映する。
- `docs/server-modernization/MODERNIZED_REST_API_INVENTORY.md` の「監査ログ強化予定」記載を解消する。

## 実施内容
- スタンプ削除の監査詳細に `errorMessage` を追加し、NotFound/例外時の失敗理由を監査で追えるよう補完。
- `MODERNIZED_REST_API_INVENTORY.md` のスタンプ削除行から「監査ログ強化予定」を削除し、整合済みであることを明記。

## 検証・整合チェック
- `StampResource` の監査 payload に `requestId/traceId` が設定されることを確認（既存 `createBaseAuditPayload` にて分離済み）。
- 失敗時に `errorMessage` が監査詳細に残ることを実装で確認。
- 要件ドキュメント（`src/predeploy_readiness/01_api_implementation/監査・ログAPI要件ドキュメント整備.md`）との必須フィールド整合を確認。

## 変更ファイル
- `server-modernized/src/main/java/open/dolphin/rest/StampResource.java`
- `docs/server-modernization/MODERNIZED_REST_API_INVENTORY.md`

## 証跡
- コミット: `f42ca095`（スタンプ削除監査の errorMessage 追加と inventory 文言更新）

## 留意点
- Legacy/Phase2 ドキュメントは参照のみで更新対象外。
- ORCA 実環境接続/Stage/Preview 検証は未実施。
