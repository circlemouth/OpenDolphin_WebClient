# 開発ドキュメント総点検（2025-12-20）

## 目的
`docs/DEVELOPMENT_STATUS.md` を単一参照元として現行の不足事項を一次整理し、Web クライアントとモダナイズ版サーバーの仕様差分を抽出する。
Phase2 文書は Legacy 参照として差分確認のみに使用する。

## 参照ソース（単一参照元 + 差分確認のみの Legacy）
- 単一参照元: `docs/DEVELOPMENT_STATUS.md`
- Web クライアント側の差分確認: `docs/web-client/architecture/web-client-api-mapping.md`（Legacy）
- Web クライアント運用/UX差分確認: `docs/web-client/ux/admin-delivery-validation.md` / `docs/web-client/ux/playwright-scenarios.md`（Legacy）
- モダナイズ版サーバー API: `docs/server-modernization/MODERNIZED_REST_API_INVENTORY.md`
- 旧サーバー API: `docs/server/LEGACY_REST_API_INVENTORY.md`

## 1. `docs/DEVELOPMENT_STATUS.md` から見える不足事項（一次整理）
`docs/DEVELOPMENT_STATUS.md` には「単一参照である」ことと参照優先順が記載されているが、現行フェーズの**不足事項や未完了項目の具体的な一覧が存在しない**。そのため、以下の観点が欠落している。

- **現行の未完了タスク/ギャップ一覧**: Web クライアントとモダナイズ版サーバーの具体的な不足項目が記載されていない。
- **仕様差分の公式表**: 旧サーバー/モダナイズ版/ Web クライアントの差分サマリが `DEVELOPMENT_STATUS` に無い。
- **検証/稼働前の前提条件**: Stage/Preview 検証や MSW OFF 検証の最新状況が `DEVELOPMENT_STATUS` で追跡できない。
- **担当/責任の割当**: マネージャー指示・チケットへのリンクは示されるが、具体的な責任分解や期限が `DEVELOPMENT_STATUS` には記載されていない。

> 結論: 現行の不足事項を `DEVELOPMENT_STATUS` に集約する前提のため、**不足事項そのものが同ファイルに未記載**という状態が一次的な不足。

## 2. Web クライアント vs モダナイズ版サーバー 仕様差分（抽出）
以下はドキュメント上の差分であり、**Phase2 文書は差分確認のみに使用**している。

### 2.1 Web クライアントが前提としている API（Legacy 文書）
`docs/web-client/architecture/web-client-api-mapping.md` で明記される主要エンドポイント:
- `/orca/claim/outpatient/*`
- `/orca/appointments/list/*`
- `/orca21/medicalmodv2/outpatient`
- `/orca12/patientmodv2/outpatient`

さらに UX/運用文書で前提化されるエンドポイント:
- `/api/admin/config` / `/api/admin/delivery`
- `/api/orca/queue`
- `/charts/print/outpatient`

### 2.2 モダナイズ版サーバー API インベントリとの差分
`docs/server-modernization/MODERNIZED_REST_API_INVENTORY.md` には以下の記載が存在しない。
- **Web クライアント側が前提とするアウトカム系 API**
  - `/orca/claim/outpatient/*`
  - `/orca/appointments/list/*`
  - `/orca21/medicalmodv2/outpatient`
  - `/orca12/patientmodv2/outpatient`
- **Web クライアント運用・配信/監査向け API**
  - `/api/admin/config` / `/api/admin/delivery`
  - `/api/orca/queue`
- **UI ルーティング（Web）**
  - `/charts/print/outpatient`（Web クライアント側の画面ルート）

一方で、モダナイズ版サーバーは `/api01rv2/*` を ORCA ラッパーとして多数実装済みであり、
Web クライアント側のアウトカム API と名称・構造が一致しない。

### 2.3 旧サーバーとモダナイズ版の差分（参考）
`docs/server/LEGACY_REST_API_INVENTORY.md` と `docs/server-modernization/MODERNIZED_REST_API_INVENTORY.md` を比較すると、
以下の差分が確認できる。
- **Legacy に存在するが Modernized に記載が無い**
  - `/dolphin`（簡易ヘルスチェック）
  - `/dolphin`（施設管理者の一括登録）
  - `/pvt2/*`（受付拡張）
  - `/mml/*` の一部における引数/戻り値の非互換
- **Modernized で拡張されたが Legacy 文書に無い**
  - `/chart-events` (SSE ストリーム)

> 注: 旧サーバーとの差分は「参考」であり、**現行の差分判断は `DEVELOPMENT_STATUS` 優先**。

## 3. まとめ（一次整理）
- `docs/DEVELOPMENT_STATUS.md` に「現行の不足事項の具体的一覧」が存在しないため、**不足事項の一次整理そのものが未記載**という状態。
- Web クライアントが前提とするアウトカム API（`/orca/claim/outpatient/*` など）が、
  モダナイズ版サーバーのインベントリに記載されておらず、**仕様差分が顕在化**している。
- 配信/監査/キュー系 API（`/api/admin/*`, `/api/orca/queue`）がモダナイズ版サーバーの
  API インベントリに存在せず、**運用設計上の差分**として整理が必要。

## 4. 次アクション候補（記録のみ）
- `docs/DEVELOPMENT_STATUS.md` に **不足事項/未完了項目の一覧セクション**を追加し、
  本ドキュメントの差分結果を一次リストとして集約するか判断する。
- Web クライアントのアウトカム API を、
  モダナイズ版サーバー側のインベントリと対応付ける **差分表（1ページ）**を作成する。

