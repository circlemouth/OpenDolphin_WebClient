# 20 旧来→Web対応表と差分整理

- RUN_ID: `20260106T072231Z`
- 期間: 2026-01-07 15:00 〜 2026-01-08 15:00 (JST) / 優先度: high / 緊急度: high / エージェント: codex
- YAML ID: `src/webclient_screen_structure_plan/analysis/20_旧来→Web対応表と差分整理.md`

## 参照
- `docs/DEVELOPMENT_STATUS.md`
- `src/webclient_screen_structure_plan/inventory/10_旧来型画面構成の棚卸し.md`
- `src/webclient_screen_structure_plan/inventory/11_Web画面構成の棚卸し.md`

## 画面不足の優先度定義
- P0: 診療のコア導線に直結し、欠落すると当日運用が成立しないもの（受付・カルテ・患者登録など）。
- P1: 代替手段があるが、日次運用の効率/品質に影響するもの（検索/予定/印刷など）。
- P2: 低頻度または管理系で、段階的導入でも許容できるもの（統計/施設設定など）。

## 旧来→Web 対応表（不足/過剰/統合候補の分類）

| 旧来画面/機能 | Web画面対応 | 状態 | ギャップ/メモ | 不足優先度 |
| --- | --- | --- | --- | --- |
| ログイン | `/login`, `/f/:facilityId/login` | 対応 | Web は facilityId 固定ログインを追加。 | - |
| メインウィンドウ（タブ集約） | 施設シェル `/f/:facilityId` | 統合候補 | 旧来のタブ集約は Web ではルーティングに置換。統合済み扱い。 | - |
| 受付リスト | `/f/:facilityId/reception` | 対応 | 旧来の受付リストに相当。 | - |
| 患者検索 | `/f/:facilityId/patients` | 統合候補 | 旧来の患者検索は Web の患者管理に統合想定。詳細機能の突合が必要。 | P1 |
| 予定患者 | （該当ルートなし） | 未対応 | 旧来の予定カルテ管理に相当。 | P1 |
| ラボレシーバ | （該当ルートなし） | 未対応 | ラボ結果取り込み。Web での受け口未確認。 | P2 |
| カルテ画面（編集） | `/f/:facilityId/charts` | 対応 | 旧来カルテの中心画面に対応。 | - |
| カルテ参照ビュー（更新タブ） | `/f/:facilityId/charts` | 統合候補 | Web のカルテ内参照機能に統合想定。参照専用ビューの明示は未確認。 | P1 |
| 文書エディタ（紹介状等） | `/f/:facilityId/charts` + `/charts/print/document` | 統合候補 | 文書編集がカルテ内に統合されている想定。作成 UI の有無は未確認。 | P1 |
| 新規カルテダイアログ | `/f/:facilityId/charts` | 未確認 | 旧来の「コピー/空白/前回処方」選択導線が Web にあるか未確認。 | P0 |
| カルテ削除ダイアログ | `/f/:facilityId/charts` | 未確認 | 削除理由選択ダイアログの有無は未確認。 | P1 |
| カルテ印刷ダイアログ | `/f/:facilityId/charts/print/outpatient` | 対応 | 印刷プレビューは Web で専用ルート。 | - |
| 新患登録 | `/f/:facilityId/patients` | 対応 | 患者管理で新規登録に対応想定。 | - |
| スタンプ箱 | （該当ルートなし） | 未対応 | 旧来のスタンプ管理/挿入 UI は Web で未確認。 | P1 |
| シェーマボックス | （該当ルートなし） | 未対応 | 旧来のシェーマ管理 UI は Web で未確認。 | P1 |
| パスワード変更 | （該当ルートなし） | 未対応 | プロフィール変更メニューの相当が未確認。 | P2 |
| 施設情報編集 | `/f/:facilityId/administration` | 統合候補 | Administration での設定編集に統合想定。現行は配信中心のため機能差分あり。 | P2 |
| 院内ユーザー登録 | `/f/:facilityId/administration` | 統合候補 | ユーザー管理は Admin に統合想定。現状の UI 実装は未確認。 | P2 |
| 統計情報 | （該当ルートなし） | 未対応 | 活動統計画面が Web に未確認。 | P2 |
| 医療機関コード読込 | （該当ルートなし） | 未対応 | 施設コード取得 UI が Web に未確認。 | P2 |
| 受付バーコード | （該当ルートなし） | 未対応 | 旧来でもメニュー無効。Web 導入優先度は低。 | P2 |
| 一括カルテPDF | （該当ルートなし） | 未対応 | 全患者出力 UI が Web に未確認。 | P2 |
| 稼働確認 | （該当ルートなし） | 未対応 | PVT/CLAIM 稼働確認の導線が Web に未確認。 | P2 |
| バージョン情報 | （該当ルートなし） | 未対応 | About 画面の導線が Web に未確認。 | P2 |
| 施設不一致ガード画面 | `/f/:facilityId/*` mismatch | 過剰（Web固有） | Web ルーティングの安全装置。旧来には該当なし。 | - |
| Outpatient Mock | `/f/:facilityId/outpatient-mock` | 過剰（検証専用） | 本番導線から除外確定。 | - |

## 不足画面の優先度まとめ

### P0
- 新規カルテ作成導線（旧来の新規カルテダイアログ相当）

### P1
- 患者検索の詳細機能差分（旧来の検索/受付登録/右クリック導線の統合）
- 予定患者（予定カルテ）
- カルテ参照ビュー（参照専用/更新タブ）
- 文書エディタ（紹介状など）
- カルテ削除理由ダイアログ
- スタンプ箱
- シェーマボックス

### P2
- ラボレシーバ
- パスワード変更
- 施設情報編集/院内ユーザー登録（Administration への統合対象）
- 統計情報
- 医療機関コード読込
- 受付バーコード
- 一括カルテPDF
- 稼働確認
- バージョン情報

## 過剰/統合候補の整理
- 過剰（Web固有）: 施設固定ログイン/施設不一致ガード/Outpatient Mock。
- 統合候補: 患者検索→患者管理、旧来メインタブ→Web ルート、施設情報編集/ユーザー管理→Administration、文書編集→Charts 内部機能。

## 次の確認ポイント（差分確定のための調査）
- Charts 内で「新規カルテ作成」「文書作成」「参照ビュー」「削除理由」「スタンプ/シェーマ」機能が現状どこまで実装済みか。
- Patients 画面で旧来患者検索の右クリック導線（受付登録/カルテ起動）が再現されているか。
- Administration で施設情報/ユーザー管理がどこまでカバーされているか。
