# 20 旧来→Web対応表と差分整理

- RUN_ID: `20260106T072231Z`
- 期間: 2026-01-07 15:00 〜 2026-01-08 15:00 (JST) / 優先度: high / 緊急度: high / エージェント: codex
- YAML ID: `src/webclient_screen_structure_plan/analysis/20_旧来→Web対応表と差分整理.md`

## 参照
- `docs/DEVELOPMENT_STATUS.md`
- `src/webclient_screen_structure_plan/inventory/10_旧来型画面構成の棚卸し.md`（旧来メニュー/ツールバー導線、旧来メイン画面（タブ）一覧、旧来サブ画面/ダイアログ一覧）
- `src/webclient_screen_structure_plan/inventory/11_Web画面構成の棚卸し.md`（画面構成一覧、ルート挙動、本番導線として不適切な画面）

## 画面不足の優先度定義
- P0: 診療のコア導線に直結し、欠落すると当日運用が成立しないもの（受付・カルテ・患者登録など）。
- P1: 代替手段があるが、日次運用の効率/品質に影響するもの（検索/予定/印刷など）。
- P2: 低頻度または管理系で、段階的導入でも許容できるもの（統計/施設設定など）。

## 旧来→Web 対応表（不足/過剰/統合候補の分類）

| 旧来画面/機能 | 旧来導線名（メニュー/タブ/ダイアログ） | Web画面対応 | 状態 | ギャップ/メモ | 不足優先度 |
| --- | --- | --- | --- | --- | --- |
| ログイン | 起動時ログイン | `/login`, `/f/:facilityId/login` | 対応 | Web は facilityId 固定ログインを追加。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」と 11_Web の「画面構成一覧」。 | - |
| メインウィンドウ（タブ集約） | メインウィンドウ/メインタブ | 施設シェル `/f/:facilityId` | 統合候補 | 旧来のタブ集約は Web ではルーティングに置換。根拠: 10_旧来の「旧来メイン画面（タブ）一覧」、11_Web の「ルート挙動」。 | - |
| 受付リスト | メインタブ: 受付リスト | `/f/:facilityId/reception` | 対応 | 旧来の受付リストに相当。根拠: 10_旧来の「旧来メイン画面（タブ）一覧」、11_Web の「画面構成一覧」。 | - |
| 患者検索 | メインタブ: 患者検索 | `/f/:facilityId/patients` | 統合候補 | 旧来の患者検索は Web の患者管理に統合想定。根拠: 10_旧来の「旧来メイン画面（タブ）一覧」、11_Web の「画面構成一覧」。詳細機能は未確認。 | P1 |
| 予定患者 | メインタブ: 予定患者 | （該当ルートなし） | 未対応 | 旧来の予定カルテ管理。根拠: 10_旧来の「旧来メイン画面（タブ）一覧」、11_Web の「画面構成一覧」に該当ルート記載なし。 | P1 |
| ラボレシーバ | メインタブ: ラボレシーバ | （該当ルートなし） | 未対応 | ラボ結果取り込み。根拠: 10_旧来の「旧来メイン画面（タブ）一覧」、11_Web の「画面構成一覧」に該当ルート記載なし。 | P2 |
| カルテ画面（編集） | 受付/患者検索/ファイル>開く/ファイル>新規カルテ | `/f/:facilityId/charts` | 対応 | 旧来カルテの中心画面に対応。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」。 | - |
| カルテ参照ビュー（更新タブ） | カルテ画面内タブ: 更新 | `/f/:facilityId/charts` | 統合候補 | 参照専用ビューの明示は未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」、11_Web の「画面構成一覧」に専用ルートなし。 | P1 |
| 文書エディタ（紹介状等） | メニュー: ファイル>新規文書 | `/f/:facilityId/charts` + `/charts/print/document` | 統合候補 | 文書編集がカルテ内に統合されている想定。作成 UI の有無は未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」。 | P1 |
| 新規カルテダイアログ | メニュー: ファイル>新規カルテ | `/f/:facilityId/charts` | 未確認 | 「コピー/空白/前回処方」選択導線が Web にあるか未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」に専用ルート/記載なし。 | P0 |
| カルテ削除ダイアログ | メニュー: ファイル>削除 | `/f/:facilityId/charts` | 未確認 | 削除理由選択ダイアログの有無は未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」に専用ルート/記載なし。 | P1 |
| カルテ印刷ダイアログ | メニュー: ファイル>プリント | `/f/:facilityId/charts/print/outpatient` | 対応 | 印刷プレビューは Web で専用ルート。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」。 | - |
| 新患登録 | メニュー: ツール>新患登録 | `/f/:facilityId/patients` | 対応 | 患者管理で新規登録に対応想定。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」。 | - |
| スタンプ箱 | メニュー: ツール>スタンプボックス | （該当ルートなし） | 未対応 | スタンプ管理/挿入 UI は Web で未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」に該当ルート記載なし。 | P1 |
| シェーマボックス | メニュー: ツール>シェーマボックス | （該当ルートなし） | 未対応 | シェーマ管理 UI は Web で未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」に該当ルート記載なし。 | P1 |
| パスワード変更 | メニュー: ツール>プロフィール変更 | （該当ルートなし） | 未対応 | プロフィール変更相当の導線が Web で未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」に該当ルート記載なし。 | P2 |
| 施設情報編集 | メニュー: ツール>施設情報編集 | `/f/:facilityId/administration` | 統合候補 | Administration での設定編集に統合想定。現行は配信中心のため機能差分あり。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」、11_Web の「画面構成一覧」。 | P2 |
| 院内ユーザー登録 | メニュー: ツール>院内ユーザー登録 | `/f/:facilityId/administration` | 統合候補 | ユーザー管理は Admin に統合想定。UI 実装は未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」、11_Web の「画面構成一覧」。 | P2 |
| 統計情報 | メニュー: ツール>統計情報 | （該当ルートなし） | 未対応 | 活動統計画面が Web に未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」に該当ルート記載なし。 | P2 |
| 医療機関コード読込 | メニュー: ツール>医療機関コード読込 | （該当ルートなし） | 未対応 | 施設コード取得 UI が Web に未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」に該当ルート記載なし。 | P2 |
| 受付バーコード | メニュー: ツール>受付バーコード | （該当ルートなし） | 未対応 | 旧来でもメニュー無効。Web 導入優先度は低。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」。 | P2 |
| 一括カルテPDF | メニュー: ツール>一括カルテPDF | （該当ルートなし） | 未対応 | 全患者出力 UI が Web に未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」に該当ルート記載なし。 | P2 |
| 稼働確認 | メニュー: 情報>稼働確認 | （該当ルートなし） | 未対応 | PVT/CLAIM 稼働確認の導線が Web に未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」に該当ルート記載なし。 | P2 |
| バージョン情報 | メニュー: 情報>情報 | （該当ルートなし） | 未対応 | About 画面の導線が Web に未確認。根拠: 10_旧来の「旧来サブ画面/ダイアログ一覧」「旧来メニュー/ツールバー導線」、11_Web の「画面構成一覧」に該当ルート記載なし。 | P2 |
| 施設不一致ガード画面 | なし（Web固有） | `/f/:facilityId/*` mismatch | 過剰（Web固有） | Web ルーティングの安全装置。根拠: 11_Web の「ルート挙動」「画面構成一覧」。 | - |
| Outpatient Mock | なし（Web固有） | `/f/:facilityId/outpatient-mock` | 過剰（検証専用） | 本番導線から除外確定。根拠: 11_Web の「本番導線として不適切な画面」。 | - |

## 不足画面の優先度まとめ（業務影響で再分類）

### 受付
- P1 予定患者（予定カルテ）: 受付前の予定管理が欠落し、日次運用の調整コストが増えるため。
- P1 患者検索の詳細機能差分: 受付登録/カルテ起動の導線差分は受付処理の効率に直結するため。

### カルテ
- P0 新規カルテ作成導線: 当日診療の開始操作に直結し、欠落すると運用が成立しないため。
- P1 カルテ参照ビュー（参照専用/更新タブ）: 参照中心運用の効率/安全性に影響するため。
- P1 カルテ削除理由ダイアログ: 監査/運用ルールに関わり、代替手段が限定的なため。
- P1 スタンプ箱: 診療入力の効率に直結し、日次業務の負荷が上がるため。
- P1 シェーマボックス: 図示入力の効率に直結し、現場運用の負荷が上がるため。

### 文書
- P1 文書エディタ（紹介状など）: 文書作成の導線が不足すると業務品質に影響するため。

### 検査
- P2 ラボレシーバ: 低頻度運用だが必要時の取り込みができないため。

### 管理
- P2 パスワード変更: セキュリティ運用上は必要だが緊急性は低いため。
- P2 施設情報編集/院内ユーザー登録: 管理系機能で段階的導入が可能なため。
- P2 統計情報: 定期閲覧用途で即時性が低いため。
- P2 医療機関コード読込: 低頻度運用で段階的導入が可能なため。
- P2 受付バーコード: 旧来でも無効化で、導入優先度が低いため。
- P2 一括カルテPDF: 低頻度の一括出力用途のため。
- P2 稼働確認: 監視用途で日次必須ではないため。
- P2 バージョン情報: 参照目的で即時性が低いため。

## 過剰/統合候補の整理
- 過剰（Web固有）: 施設固定ログイン（ログイン画面内）、施設不一致ガード（ルーティング基盤）、Outpatient Mock（別画面/検証専用）。
- 統合候補: 患者検索→Patients 内、旧来メインタブ→FacilityShell/AppRouter、施設情報編集/ユーザー管理→Administration 内、文書編集→Charts 内。

## 次の確認ポイント（差分確定のための調査）
- Charts 内で「新規カルテ作成」「文書作成」「参照ビュー」「削除理由」「スタンプ/シェーマ」機能が現状どこまで実装済みか。
- Patients 画面で旧来患者検索の右クリック導線（受付登録/カルテ起動）が再現されているか。
- Administration で施設情報/ユーザー管理がどこまでカバーされているか。
